<!DOCTYPE html>
<html lang="en">
<head>
<meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<meta name="generator" content="Asciidoctor 2.0.15">
<title>corva-sdk</title>
<link rel="stylesheet" href="https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700">
<style>
/* Asciidoctor default stylesheet | MIT License | https://asciidoctor.org */
/* Uncomment @import statement to use as custom stylesheet */
/*@import "https://fonts.googleapis.com/css?family=Open+Sans:300,300italic,400,400italic,600,600italic%7CNoto+Serif:400,400italic,700,700italic%7CDroid+Sans+Mono:400,700";*/
article,aside,details,figcaption,figure,footer,header,hgroup,main,nav,section{display:block}
audio,video{display:inline-block}
audio:not([controls]){display:none;height:0}
html{font-family:sans-serif;-ms-text-size-adjust:100%;-webkit-text-size-adjust:100%}
a{background:none}
a:focus{outline:thin dotted}
a:active,a:hover{outline:0}
h1{font-size:2em;margin:.67em 0}
abbr[title]{border-bottom:1px dotted}
b,strong{font-weight:bold}
dfn{font-style:italic}
hr{-moz-box-sizing:content-box;box-sizing:content-box;height:0}
mark{background:#ff0;color:#000}
code,kbd,pre,samp{font-family:monospace;font-size:1em}
pre{white-space:pre-wrap}
q{quotes:"\201C" "\201D" "\2018" "\2019"}
small{font-size:80%}
sub,sup{font-size:75%;line-height:0;position:relative;vertical-align:baseline}
sup{top:-.5em}
sub{bottom:-.25em}
img{border:0}
svg:not(:root){overflow:hidden}
figure{margin:0}
fieldset{border:1px solid silver;margin:0 2px;padding:.35em .625em .75em}
legend{border:0;padding:0}
button,input,select,textarea{font-family:inherit;font-size:100%;margin:0}
button,input{line-height:normal}
button,select{text-transform:none}
button,html input[type="button"],input[type="reset"],input[type="submit"]{-webkit-appearance:button;cursor:pointer}
button[disabled],html input[disabled]{cursor:default}
input[type="checkbox"],input[type="radio"]{box-sizing:border-box;padding:0}
button::-moz-focus-inner,input::-moz-focus-inner{border:0;padding:0}
textarea{overflow:auto;vertical-align:top}
table{border-collapse:collapse;border-spacing:0}
*,*::before,*::after{-moz-box-sizing:border-box;-webkit-box-sizing:border-box;box-sizing:border-box}
html,body{font-size:100%}
body{background:#fff;color:rgba(0,0,0,.8);padding:0;margin:0;font-family:"Noto Serif","DejaVu Serif",serif;font-weight:400;font-style:normal;line-height:1;position:relative;cursor:auto;tab-size:4;word-wrap:anywhere;-moz-osx-font-smoothing:grayscale;-webkit-font-smoothing:antialiased}
a:hover{cursor:pointer}
img,object,embed{max-width:100%;height:auto}
object,embed{height:100%}
img{-ms-interpolation-mode:bicubic}
.left{float:left!important}
.right{float:right!important}
.text-left{text-align:left!important}
.text-right{text-align:right!important}
.text-center{text-align:center!important}
.text-justify{text-align:justify!important}
.hide{display:none}
img,object,svg{display:inline-block;vertical-align:middle}
textarea{height:auto;min-height:50px}
select{width:100%}
.subheader,.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{line-height:1.45;color:#7a2518;font-weight:400;margin-top:0;margin-bottom:.25em}
div,dl,dt,dd,ul,ol,li,h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6,pre,form,p,blockquote,th,td{margin:0;padding:0}
a{color:#2156a5;text-decoration:underline;line-height:inherit}
a:hover,a:focus{color:#1d4b8f}
a img{border:0}
p{font-family:inherit;font-weight:400;font-size:1em;line-height:1.6;margin-bottom:1.25em;text-rendering:optimizeLegibility}
p aside{font-size:.875em;line-height:1.35;font-style:italic}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{font-family:"Open Sans","DejaVu Sans",sans-serif;font-weight:300;font-style:normal;color:#ba3925;text-rendering:optimizeLegibility;margin-top:1em;margin-bottom:.5em;line-height:1.0125em}
h1 small,h2 small,h3 small,#toctitle small,.sidebarblock>.content>.title small,h4 small,h5 small,h6 small{font-size:60%;color:#e99b8f;line-height:0}
h1{font-size:2.125em}
h2{font-size:1.6875em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.375em}
h4,h5{font-size:1.125em}
h6{font-size:1em}
hr{border:solid #dddddf;border-width:1px 0 0;clear:both;margin:1.25em 0 1.1875em;height:0}
em,i{font-style:italic;line-height:inherit}
strong,b{font-weight:bold;line-height:inherit}
small{font-size:60%;line-height:inherit}
code{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;font-weight:400;color:rgba(0,0,0,.9)}
ul,ol,dl{font-size:1em;line-height:1.6;margin-bottom:1.25em;list-style-position:outside;font-family:inherit}
ul,ol{margin-left:1.5em}
ul li ul,ul li ol{margin-left:1.25em;margin-bottom:0;font-size:1em}
ul.square li ul,ul.circle li ul,ul.disc li ul{list-style:inherit}
ul.square{list-style-type:square}
ul.circle{list-style-type:circle}
ul.disc{list-style-type:disc}
ol li ul,ol li ol{margin-left:1.25em;margin-bottom:0}
dl dt{margin-bottom:.3125em;font-weight:bold}
dl dd{margin-bottom:1.25em}
abbr,acronym{text-transform:uppercase;font-size:90%;color:rgba(0,0,0,.8);border-bottom:1px dotted #ddd;cursor:help}
abbr{text-transform:none}
blockquote{margin:0 0 1.25em;padding:.5625em 1.25em 0 1.1875em;border-left:1px solid #ddd}
blockquote,blockquote p{line-height:1.6;color:rgba(0,0,0,.85)}
@media screen and (min-width:768px){h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2}
h1{font-size:2.75em}
h2{font-size:2.3125em}
h3,#toctitle,.sidebarblock>.content>.title{font-size:1.6875em}
h4{font-size:1.4375em}}
table{background:#fff;margin-bottom:1.25em;border:solid 1px #dedede;word-wrap:normal}
table thead,table tfoot{background:#f7f8f7}
table thead tr th,table thead tr td,table tfoot tr th,table tfoot tr td{padding:.5em .625em .625em;font-size:inherit;color:rgba(0,0,0,.8);text-align:left}
table tr th,table tr td{padding:.5625em .625em;font-size:inherit;color:rgba(0,0,0,.8)}
table tr.even,table tr.alt{background:#f8f8f7}
table thead tr th,table tfoot tr th,table tbody tr td,table tr td,table tfoot tr td{line-height:1.6}
h1,h2,h3,#toctitle,.sidebarblock>.content>.title,h4,h5,h6{line-height:1.2;word-spacing:-.05em}
h1 strong,h2 strong,h3 strong,#toctitle strong,.sidebarblock>.content>.title strong,h4 strong,h5 strong,h6 strong{font-weight:400}
.center{margin-left:auto;margin-right:auto}
.stretch{width:100%}
.clearfix::before,.clearfix::after,.float-group::before,.float-group::after{content:" ";display:table}
.clearfix::after,.float-group::after{clear:both}
:not(pre).nobreak{word-wrap:normal}
:not(pre).nowrap{white-space:nowrap}
:not(pre).pre-wrap{white-space:pre-wrap}
:not(pre):not([class^=L])>code{font-size:.9375em;font-style:normal!important;letter-spacing:0;padding:.1em .5ex;word-spacing:-.15em;background:#f7f7f8;-webkit-border-radius:4px;border-radius:4px;line-height:1.45;text-rendering:optimizeSpeed}
pre{color:rgba(0,0,0,.9);font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;line-height:1.45;text-rendering:optimizeSpeed}
pre code,pre pre{color:inherit;font-size:inherit;line-height:inherit}
pre>code{display:block}
pre.nowrap,pre.nowrap pre{white-space:pre;word-wrap:normal}
em em{font-style:normal}
strong strong{font-weight:400}
.keyseq{color:rgba(51,51,51,.8)}
kbd{font-family:"Droid Sans Mono","DejaVu Sans Mono",monospace;display:inline-block;color:rgba(0,0,0,.8);font-size:.65em;line-height:1.45;background:#f7f7f7;border:1px solid #ccc;-webkit-border-radius:3px;border-radius:3px;-webkit-box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em white inset;box-shadow:0 1px 0 rgba(0,0,0,.2),0 0 0 .1em #fff inset;margin:0 .15em;padding:.2em .5em;vertical-align:middle;position:relative;top:-.1em;white-space:nowrap}
.keyseq kbd:first-child{margin-left:0}
.keyseq kbd:last-child{margin-right:0}
.menuseq,.menuref{color:#000}
.menuseq b:not(.caret),.menuref{font-weight:inherit}
.menuseq{word-spacing:-.02em}
.menuseq b.caret{font-size:1.25em;line-height:.8}
.menuseq i.caret{font-weight:bold;text-align:center;width:.45em}
b.button::before,b.button::after{position:relative;top:-1px;font-weight:400}
b.button::before{content:"[";padding:0 3px 0 2px}
b.button::after{content:"]";padding:0 2px 0 3px}
p a>code:hover{color:rgba(0,0,0,.9)}
#header,#content,#footnotes,#footer{width:100%;margin-left:auto;margin-right:auto;margin-top:0;margin-bottom:0;max-width:62.5em;*zoom:1;position:relative;padding-left:.9375em;padding-right:.9375em}
#header::before,#header::after,#content::before,#content::after,#footnotes::before,#footnotes::after,#footer::before,#footer::after{content:" ";display:table}
#header::after,#content::after,#footnotes::after,#footer::after{clear:both}
#content{margin-top:1.25em}
#content::before{content:none}
#header>h1:first-child{color:rgba(0,0,0,.85);margin-top:2.25rem;margin-bottom:0}
#header>h1:first-child+#toc{margin-top:8px;border-top:1px solid #dddddf}
#header>h1:only-child,body.toc2 #header>h1:nth-last-child(2){border-bottom:1px solid #dddddf;padding-bottom:8px}
#header .details{border-bottom:1px solid #dddddf;line-height:1.45;padding-top:.25em;padding-bottom:.25em;padding-left:.25em;color:rgba(0,0,0,.6);display:-ms-flexbox;display:-webkit-flex;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap}
#header .details span:first-child{margin-left:-.125em}
#header .details span.email a{color:rgba(0,0,0,.85)}
#header .details br{display:none}
#header .details br+span::before{content:"\00a0\2013\00a0"}
#header .details br+span.author::before{content:"\00a0\22c5\00a0";color:rgba(0,0,0,.85)}
#header .details br+span#revremark::before{content:"\00a0|\00a0"}
#header #revnumber{text-transform:capitalize}
#header #revnumber::after{content:"\00a0"}
#content>h1:first-child:not([class]){color:rgba(0,0,0,.85);border-bottom:1px solid #dddddf;padding-bottom:8px;margin-top:0;padding-top:1rem;margin-bottom:1.25rem}
#toc{border-bottom:1px solid #e7e7e9;padding-bottom:.5em}
#toc>ul{margin-left:.125em}
#toc ul.sectlevel0>li>a{font-style:italic}
#toc ul.sectlevel0 ul.sectlevel1{margin:.5em 0}
#toc ul{font-family:"Open Sans","DejaVu Sans",sans-serif;list-style-type:none}
#toc li{line-height:1.3334;margin-top:.3334em}
#toc a{text-decoration:none}
#toc a:active{text-decoration:underline}
#toctitle{color:#7a2518;font-size:1.2em}
@media screen and (min-width:768px){#toctitle{font-size:1.375em}
body.toc2{padding-left:15em;padding-right:0}
#toc.toc2{margin-top:0!important;background:#f8f8f7;position:fixed;width:15em;left:0;top:0;border-right:1px solid #e7e7e9;border-top-width:0!important;border-bottom-width:0!important;z-index:1000;padding:1.25em 1em;height:100%;overflow:auto}
#toc.toc2 #toctitle{margin-top:0;margin-bottom:.8rem;font-size:1.2em}
#toc.toc2>ul{font-size:.9em;margin-bottom:0}
#toc.toc2 ul ul{margin-left:0;padding-left:1em}
#toc.toc2 ul.sectlevel0 ul.sectlevel1{padding-left:0;margin-top:.5em;margin-bottom:.5em}
body.toc2.toc-right{padding-left:0;padding-right:15em}
body.toc2.toc-right #toc.toc2{border-right-width:0;border-left:1px solid #e7e7e9;left:auto;right:0}}
@media screen and (min-width:1280px){body.toc2{padding-left:20em;padding-right:0}
#toc.toc2{width:20em}
#toc.toc2 #toctitle{font-size:1.375em}
#toc.toc2>ul{font-size:.95em}
#toc.toc2 ul ul{padding-left:1.25em}
body.toc2.toc-right{padding-left:0;padding-right:20em}}
#content #toc{border-style:solid;border-width:1px;border-color:#e0e0dc;margin-bottom:1.25em;padding:1.25em;background:#f8f8f7;-webkit-border-radius:4px;border-radius:4px}
#content #toc>:first-child{margin-top:0}
#content #toc>:last-child{margin-bottom:0}
#footer{max-width:none;background:rgba(0,0,0,.8);padding:1.25em}
#footer-text{color:rgba(255,255,255,.8);line-height:1.44}
#content{margin-bottom:.625em}
.sect1{padding-bottom:.625em}
@media screen and (min-width:768px){#content{margin-bottom:1.25em}
.sect1{padding-bottom:1.25em}}
.sect1:last-child{padding-bottom:0}
.sect1+.sect1{border-top:1px solid #e7e7e9}
#content h1>a.anchor,h2>a.anchor,h3>a.anchor,#toctitle>a.anchor,.sidebarblock>.content>.title>a.anchor,h4>a.anchor,h5>a.anchor,h6>a.anchor{position:absolute;z-index:1001;width:1.5ex;margin-left:-1.5ex;display:block;text-decoration:none!important;visibility:hidden;text-align:center;font-weight:400}
#content h1>a.anchor::before,h2>a.anchor::before,h3>a.anchor::before,#toctitle>a.anchor::before,.sidebarblock>.content>.title>a.anchor::before,h4>a.anchor::before,h5>a.anchor::before,h6>a.anchor::before{content:"\00A7";font-size:.85em;display:block;padding-top:.1em}
#content h1:hover>a.anchor,#content h1>a.anchor:hover,h2:hover>a.anchor,h2>a.anchor:hover,h3:hover>a.anchor,#toctitle:hover>a.anchor,.sidebarblock>.content>.title:hover>a.anchor,h3>a.anchor:hover,#toctitle>a.anchor:hover,.sidebarblock>.content>.title>a.anchor:hover,h4:hover>a.anchor,h4>a.anchor:hover,h5:hover>a.anchor,h5>a.anchor:hover,h6:hover>a.anchor,h6>a.anchor:hover{visibility:visible}
#content h1>a.link,h2>a.link,h3>a.link,#toctitle>a.link,.sidebarblock>.content>.title>a.link,h4>a.link,h5>a.link,h6>a.link{color:#ba3925;text-decoration:none}
#content h1>a.link:hover,h2>a.link:hover,h3>a.link:hover,#toctitle>a.link:hover,.sidebarblock>.content>.title>a.link:hover,h4>a.link:hover,h5>a.link:hover,h6>a.link:hover{color:#a53221}
details,.audioblock,.imageblock,.literalblock,.listingblock,.stemblock,.videoblock{margin-bottom:1.25em}
details>summary:first-of-type{cursor:pointer;display:list-item;outline:none;margin-bottom:.75em}
.admonitionblock td.content>.title,.audioblock>.title,.exampleblock>.title,.imageblock>.title,.listingblock>.title,.literalblock>.title,.stemblock>.title,.openblock>.title,.paragraph>.title,.quoteblock>.title,table.tableblock>.title,.verseblock>.title,.videoblock>.title,.dlist>.title,.olist>.title,.ulist>.title,.qlist>.title,.hdlist>.title{text-rendering:optimizeLegibility;text-align:left;font-family:"Noto Serif","DejaVu Serif",serif;font-size:1rem;font-style:italic}
table.tableblock.fit-content>caption.title{white-space:nowrap;width:0}
.paragraph.lead>p,#preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:1.21875em;line-height:1.6;color:rgba(0,0,0,.85)}
table.tableblock #preamble>.sectionbody>[class="paragraph"]:first-of-type p{font-size:inherit}
.admonitionblock>table{border-collapse:separate;border:0;background:none;width:100%}
.admonitionblock>table td.icon{text-align:center;width:80px}
.admonitionblock>table td.icon img{max-width:none}
.admonitionblock>table td.icon .title{font-weight:bold;font-family:"Open Sans","DejaVu Sans",sans-serif;text-transform:uppercase}
.admonitionblock>table td.content{padding-left:1.125em;padding-right:1.25em;border-left:1px solid #dddddf;color:rgba(0,0,0,.6);word-wrap:anywhere}
.admonitionblock>table td.content>:last-child>:last-child{margin-bottom:0}
.exampleblock>.content{border-style:solid;border-width:1px;border-color:#e6e6e6;margin-bottom:1.25em;padding:1.25em;background:#fff;-webkit-border-radius:4px;border-radius:4px}
.exampleblock>.content>:first-child{margin-top:0}
.exampleblock>.content>:last-child{margin-bottom:0}
.sidebarblock{border-style:solid;border-width:1px;border-color:#dbdbd6;margin-bottom:1.25em;padding:1.25em;background:#f3f3f2;-webkit-border-radius:4px;border-radius:4px}
.sidebarblock>:first-child{margin-top:0}
.sidebarblock>:last-child{margin-bottom:0}
.sidebarblock>.content>.title{color:#7a2518;margin-top:0;text-align:center}
.exampleblock>.content>:last-child>:last-child,.exampleblock>.content .olist>ol>li:last-child>:last-child,.exampleblock>.content .ulist>ul>li:last-child>:last-child,.exampleblock>.content .qlist>ol>li:last-child>:last-child,.sidebarblock>.content>:last-child>:last-child,.sidebarblock>.content .olist>ol>li:last-child>:last-child,.sidebarblock>.content .ulist>ul>li:last-child>:last-child,.sidebarblock>.content .qlist>ol>li:last-child>:last-child{margin-bottom:0}
.literalblock pre,.listingblock>.content>pre{-webkit-border-radius:4px;border-radius:4px;overflow-x:auto;padding:1em;font-size:.8125em}
@media screen and (min-width:768px){.literalblock pre,.listingblock>.content>pre{font-size:.90625em}}
@media screen and (min-width:1280px){.literalblock pre,.listingblock>.content>pre{font-size:1em}}
.literalblock pre,.listingblock>.content>pre:not(.highlight),.listingblock>.content>pre[class="highlight"],.listingblock>.content>pre[class^="highlight "]{background:#f7f7f8}
.literalblock.output pre{color:#f7f7f8;background:rgba(0,0,0,.9)}
.listingblock>.content{position:relative}
.listingblock code[data-lang]::before{display:none;content:attr(data-lang);position:absolute;font-size:.75em;top:.425rem;right:.5rem;line-height:1;text-transform:uppercase;color:inherit;opacity:.5}
.listingblock:hover code[data-lang]::before{display:block}
.listingblock.terminal pre .command::before{content:attr(data-prompt);padding-right:.5em;color:inherit;opacity:.5}
.listingblock.terminal pre .command:not([data-prompt])::before{content:"$"}
.listingblock pre.highlightjs{padding:0}
.listingblock pre.highlightjs>code{padding:1em;-webkit-border-radius:4px;border-radius:4px}
.listingblock pre.prettyprint{border-width:0}
.prettyprint{background:#f7f7f8}
pre.prettyprint .linenums{line-height:1.45;margin-left:2em}
pre.prettyprint li{background:none;list-style-type:inherit;padding-left:0}
pre.prettyprint li code[data-lang]::before{opacity:1}
pre.prettyprint li:not(:first-child) code[data-lang]::before{display:none}
table.linenotable{border-collapse:separate;border:0;margin-bottom:0;background:none}
table.linenotable td[class]{color:inherit;vertical-align:top;padding:0;line-height:inherit;white-space:normal}
table.linenotable td.code{padding-left:.75em}
table.linenotable td.linenos{border-right:1px solid currentColor;opacity:.35;padding-right:.5em}
pre.pygments .lineno{border-right:1px solid currentColor;opacity:.35;display:inline-block;margin-right:.75em}
pre.pygments .lineno::before{content:"";margin-right:-.125em}
.quoteblock{margin:0 1em 1.25em 1.5em;display:table}
.quoteblock:not(.excerpt)>.title{margin-left:-1.5em;margin-bottom:.75em}
.quoteblock blockquote,.quoteblock p{color:rgba(0,0,0,.85);font-size:1.15rem;line-height:1.75;word-spacing:.1em;letter-spacing:0;font-style:italic;text-align:justify}
.quoteblock blockquote{margin:0;padding:0;border:0}
.quoteblock blockquote::before{content:"\201c";float:left;font-size:2.75em;font-weight:bold;line-height:.6em;margin-left:-.6em;color:#7a2518;text-shadow:0 1px 2px rgba(0,0,0,.1)}
.quoteblock blockquote>.paragraph:last-child p{margin-bottom:0}
.quoteblock .attribution{margin-top:.75em;margin-right:.5ex;text-align:right}
.verseblock{margin:0 1em 1.25em}
.verseblock pre{font-family:"Open Sans","DejaVu Sans",sans;font-size:1.15rem;color:rgba(0,0,0,.85);font-weight:300;text-rendering:optimizeLegibility}
.verseblock pre strong{font-weight:400}
.verseblock .attribution{margin-top:1.25rem;margin-left:.5ex}
.quoteblock .attribution,.verseblock .attribution{font-size:.9375em;line-height:1.45;font-style:italic}
.quoteblock .attribution br,.verseblock .attribution br{display:none}
.quoteblock .attribution cite,.verseblock .attribution cite{display:block;letter-spacing:-.025em;color:rgba(0,0,0,.6)}
.quoteblock.abstract blockquote::before,.quoteblock.excerpt blockquote::before,.quoteblock .quoteblock blockquote::before{display:none}
.quoteblock.abstract blockquote,.quoteblock.abstract p,.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{line-height:1.6;word-spacing:0}
.quoteblock.abstract{margin:0 1em 1.25em;display:block}
.quoteblock.abstract>.title{margin:0 0 .375em;font-size:1.15em;text-align:center}
.quoteblock.excerpt>blockquote,.quoteblock .quoteblock{padding:0 0 .25em 1em;border-left:.25em solid #dddddf}
.quoteblock.excerpt,.quoteblock .quoteblock{margin-left:0}
.quoteblock.excerpt blockquote,.quoteblock.excerpt p,.quoteblock .quoteblock blockquote,.quoteblock .quoteblock p{color:inherit;font-size:1.0625rem}
.quoteblock.excerpt .attribution,.quoteblock .quoteblock .attribution{color:inherit;font-size:.85rem;text-align:left;margin-right:0}
p.tableblock:last-child{margin-bottom:0}
td.tableblock>.content{margin-bottom:1.25em;word-wrap:anywhere}
td.tableblock>.content>:last-child{margin-bottom:-1.25em}
table.tableblock,th.tableblock,td.tableblock{border:0 solid #dedede}
table.grid-all>*>tr>*{border-width:1px}
table.grid-cols>*>tr>*{border-width:0 1px}
table.grid-rows>*>tr>*{border-width:1px 0}
table.frame-all{border-width:1px}
table.frame-ends{border-width:1px 0}
table.frame-sides{border-width:0 1px}
table.frame-none>colgroup+*>:first-child>*,table.frame-sides>colgroup+*>:first-child>*{border-top-width:0}
table.frame-none>:last-child>:last-child>*,table.frame-sides>:last-child>:last-child>*{border-bottom-width:0}
table.frame-none>*>tr>:first-child,table.frame-ends>*>tr>:first-child{border-left-width:0}
table.frame-none>*>tr>:last-child,table.frame-ends>*>tr>:last-child{border-right-width:0}
table.stripes-all tr,table.stripes-odd tr:nth-of-type(odd),table.stripes-even tr:nth-of-type(even),table.stripes-hover tr:hover{background:#f8f8f7}
th.halign-left,td.halign-left{text-align:left}
th.halign-right,td.halign-right{text-align:right}
th.halign-center,td.halign-center{text-align:center}
th.valign-top,td.valign-top{vertical-align:top}
th.valign-bottom,td.valign-bottom{vertical-align:bottom}
th.valign-middle,td.valign-middle{vertical-align:middle}
table thead th,table tfoot th{font-weight:bold}
tbody tr th{background:#f7f8f7}
tbody tr th,tbody tr th p,tfoot tr th,tfoot tr th p{color:rgba(0,0,0,.8);font-weight:bold}
p.tableblock>code:only-child{background:none;padding:0}
p.tableblock{font-size:1em}
ol{margin-left:1.75em}
ul li ol{margin-left:1.5em}
dl dd{margin-left:1.125em}
dl dd:last-child,dl dd:last-child>:last-child{margin-bottom:0}
ol>li p,ul>li p,ul dd,ol dd,.olist .olist,.ulist .ulist,.ulist .olist,.olist .ulist{margin-bottom:.625em}
ul.checklist,ul.none,ol.none,ul.no-bullet,ol.no-bullet,ol.unnumbered,ul.unstyled,ol.unstyled{list-style-type:none}
ul.no-bullet,ol.no-bullet,ol.unnumbered{margin-left:.625em}
ul.unstyled,ol.unstyled{margin-left:0}
ul.checklist{margin-left:.625em}
ul.checklist li>p:first-child>.fa-square-o:first-child,ul.checklist li>p:first-child>.fa-check-square-o:first-child{width:1.25em;font-size:.8em;position:relative;bottom:.125em}
ul.checklist li>p:first-child>input[type="checkbox"]:first-child{margin-right:.25em}
ul.inline{display:-ms-flexbox;display:-webkit-box;display:flex;-ms-flex-flow:row wrap;-webkit-flex-flow:row wrap;flex-flow:row wrap;list-style:none;margin:0 0 .625em -1.25em}
ul.inline>li{margin-left:1.25em}
.unstyled dl dt{font-weight:400;font-style:normal}
ol.arabic{list-style-type:decimal}
ol.decimal{list-style-type:decimal-leading-zero}
ol.loweralpha{list-style-type:lower-alpha}
ol.upperalpha{list-style-type:upper-alpha}
ol.lowerroman{list-style-type:lower-roman}
ol.upperroman{list-style-type:upper-roman}
ol.lowergreek{list-style-type:lower-greek}
.hdlist>table,.colist>table{border:0;background:none}
.hdlist>table>tbody>tr,.colist>table>tbody>tr{background:none}
td.hdlist1,td.hdlist2{vertical-align:top;padding:0 .625em}
td.hdlist1{font-weight:bold;padding-bottom:1.25em}
td.hdlist2{word-wrap:anywhere}
.literalblock+.colist,.listingblock+.colist{margin-top:-.5em}
.colist td:not([class]):first-child{padding:.4em .75em 0;line-height:1;vertical-align:top}
.colist td:not([class]):first-child img{max-width:none}
.colist td:not([class]):last-child{padding:.25em 0}
.thumb,.th{line-height:0;display:inline-block;border:solid 4px #fff;-webkit-box-shadow:0 0 0 1px #ddd;box-shadow:0 0 0 1px #ddd}
.imageblock.left{margin:.25em .625em 1.25em 0}
.imageblock.right{margin:.25em 0 1.25em .625em}
.imageblock>.title{margin-bottom:0}
.imageblock.thumb,.imageblock.th{border-width:6px}
.imageblock.thumb>.title,.imageblock.th>.title{padding:0 .125em}
.image.left,.image.right{margin-top:.25em;margin-bottom:.25em;display:inline-block;line-height:0}
.image.left{margin-right:.625em}
.image.right{margin-left:.625em}
a.image{text-decoration:none;display:inline-block}
a.image object{pointer-events:none}
sup.footnote,sup.footnoteref{font-size:.875em;position:static;vertical-align:super}
sup.footnote a,sup.footnoteref a{text-decoration:none}
sup.footnote a:active,sup.footnoteref a:active{text-decoration:underline}
#footnotes{padding-top:.75em;padding-bottom:.75em;margin-bottom:.625em}
#footnotes hr{width:20%;min-width:6.25em;margin:-.25em 0 .75em;border-width:1px 0 0}
#footnotes .footnote{padding:0 .375em 0 .225em;line-height:1.3334;font-size:.875em;margin-left:1.2em;margin-bottom:.2em}
#footnotes .footnote a:first-of-type{font-weight:bold;text-decoration:none;margin-left:-1.05em}
#footnotes .footnote:last-of-type{margin-bottom:0}
#content #footnotes{margin-top:-.625em;margin-bottom:0;padding:.75em 0}
.gist .file-data>table{border:0;background:#fff;width:100%;margin-bottom:0}
.gist .file-data>table td.line-data{width:99%}
div.unbreakable{page-break-inside:avoid}
.big{font-size:larger}
.small{font-size:smaller}
.underline{text-decoration:underline}
.overline{text-decoration:overline}
.line-through{text-decoration:line-through}
.aqua{color:#00bfbf}
.aqua-background{background:#00fafa}
.black{color:#000}
.black-background{background:#000}
.blue{color:#0000bf}
.blue-background{background:#0000fa}
.fuchsia{color:#bf00bf}
.fuchsia-background{background:#fa00fa}
.gray{color:#606060}
.gray-background{background:#7d7d7d}
.green{color:#006000}
.green-background{background:#007d00}
.lime{color:#00bf00}
.lime-background{background:#00fa00}
.maroon{color:#600000}
.maroon-background{background:#7d0000}
.navy{color:#000060}
.navy-background{background:#00007d}
.olive{color:#606000}
.olive-background{background:#7d7d00}
.purple{color:#600060}
.purple-background{background:#7d007d}
.red{color:#bf0000}
.red-background{background:#fa0000}
.silver{color:#909090}
.silver-background{background:#bcbcbc}
.teal{color:#006060}
.teal-background{background:#007d7d}
.white{color:#bfbfbf}
.white-background{background:#fafafa}
.yellow{color:#bfbf00}
.yellow-background{background:#fafa00}
span.icon>.fa{cursor:default}
a span.icon>.fa{cursor:inherit}
.admonitionblock td.icon [class^="fa icon-"]{font-size:2.5em;text-shadow:1px 1px 2px rgba(0,0,0,.5);cursor:default}
.admonitionblock td.icon .icon-note::before{content:"\f05a";color:#19407c}
.admonitionblock td.icon .icon-tip::before{content:"\f0eb";text-shadow:1px 1px 2px rgba(155,155,0,.8);color:#111}
.admonitionblock td.icon .icon-warning::before{content:"\f071";color:#bf6900}
.admonitionblock td.icon .icon-caution::before{content:"\f06d";color:#bf3400}
.admonitionblock td.icon .icon-important::before{content:"\f06a";color:#bf0000}
.conum[data-value]{display:inline-block;color:#fff!important;background:rgba(0,0,0,.8);-webkit-border-radius:50%;border-radius:50%;text-align:center;font-size:.75em;width:1.67em;height:1.67em;line-height:1.67em;font-family:"Open Sans","DejaVu Sans",sans-serif;font-style:normal;font-weight:bold}
.conum[data-value] *{color:#fff!important}
.conum[data-value]+b{display:none}
.conum[data-value]::after{content:attr(data-value)}
pre .conum[data-value]{position:relative;top:-.125em}
b.conum *{color:inherit!important}
.conum:not([data-value]):empty{display:none}
dt,th.tableblock,td.content,div.footnote{text-rendering:optimizeLegibility}
h1,h2,p,td.content,span.alt{letter-spacing:-.01em}
p strong,td.content strong,div.footnote strong{letter-spacing:-.005em}
p,blockquote,dt,td.content,span.alt{font-size:1.0625rem}
p{margin-bottom:1.25rem}
.sidebarblock p,.sidebarblock dt,.sidebarblock td.content,p.tableblock{font-size:1em}
.exampleblock>.content{background:#fffef7;border-color:#e0e0dc;-webkit-box-shadow:0 1px 4px #e0e0dc;box-shadow:0 1px 4px #e0e0dc}
.print-only{display:none!important}
@page{margin:1.25cm .75cm}
@media print{*{-webkit-box-shadow:none!important;box-shadow:none!important;text-shadow:none!important}
html{font-size:80%}
a{color:inherit!important;text-decoration:underline!important}
a.bare,a[href^="#"],a[href^="mailto:"]{text-decoration:none!important}
a[href^="http:"]:not(.bare)::after,a[href^="https:"]:not(.bare)::after{content:"(" attr(href) ")";display:inline-block;font-size:.875em;padding-left:.25em}
abbr[title]::after{content:" (" attr(title) ")"}
pre,blockquote,tr,img,object,svg{page-break-inside:avoid}
thead{display:table-header-group}
svg{max-width:100%}
p,blockquote,dt,td.content{font-size:1em;orphans:3;widows:3}
h2,h3,#toctitle,.sidebarblock>.content>.title{page-break-after:avoid}
#header,#content,#footnotes,#footer{max-width:none}
#toc,.sidebarblock,.exampleblock>.content{background:none!important}
#toc{border-bottom:1px solid #dddddf!important;padding-bottom:0!important}
body.book #header{text-align:center}
body.book #header>h1:first-child{border:0!important;margin:2.5em 0 1em}
body.book #header .details{border:0!important;display:block;padding:0!important}
body.book #header .details span:first-child{margin-left:0!important}
body.book #header .details br{display:block}
body.book #header .details br+span::before{content:none!important}
body.book #toc{border:0!important;text-align:left!important;padding:0!important;margin:0!important}
body.book #toc,body.book #preamble,body.book h1.sect0,body.book .sect1>h2{page-break-before:always}
.listingblock code[data-lang]::before{display:block}
#footer{padding:0 .9375em}
.hide-on-print{display:none!important}
.print-only{display:block!important}
.hide-for-print{display:none!important}
.show-for-print{display:inherit!important}}
@media print,amzn-kf8{#header>h1:first-child{margin-top:1.25rem}
.sect1{padding:0!important}
.sect1+.sect1{border:0}
#footer{background:none}
#footer-text{color:rgba(0,0,0,.6);font-size:.9em}}
@media amzn-kf8{#header,#content,#footnotes,#footer{padding:0}}
</style>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/4.7.0/css/font-awesome.min.css">
<style>
pre { line-height: 125%; }
td.linenos .normal { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
span.linenos { color: inherit; background-color: transparent; padding-left: 5px; padding-right: 5px; }
td.linenos .special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
span.linenos.special { color: #000000; background-color: #ffffc0; padding-left: 5px; padding-right: 5px; }
pre.pygments .hll { background-color: #ffffcc }
pre.pygments { background: #f8f8f8; }
pre.pygments .tok-c { color: #408080; font-style: italic } /* Comment */
pre.pygments .tok-err { border: 1px solid #FF0000 } /* Error */
pre.pygments .tok-k { color: #008000; font-weight: bold } /* Keyword */
pre.pygments .tok-o { color: #666666 } /* Operator */
pre.pygments .tok-ch { color: #408080; font-style: italic } /* Comment.Hashbang */
pre.pygments .tok-cm { color: #408080; font-style: italic } /* Comment.Multiline */
pre.pygments .tok-cp { color: #BC7A00 } /* Comment.Preproc */
pre.pygments .tok-cpf { color: #408080; font-style: italic } /* Comment.PreprocFile */
pre.pygments .tok-c1 { color: #408080; font-style: italic } /* Comment.Single */
pre.pygments .tok-cs { color: #408080; font-style: italic } /* Comment.Special */
pre.pygments .tok-gd { color: #A00000 } /* Generic.Deleted */
pre.pygments .tok-ge { font-style: italic } /* Generic.Emph */
pre.pygments .tok-gr { color: #FF0000 } /* Generic.Error */
pre.pygments .tok-gh { color: #000080; font-weight: bold } /* Generic.Heading */
pre.pygments .tok-gi { color: #00A000 } /* Generic.Inserted */
pre.pygments .tok-go { color: #888888 } /* Generic.Output */
pre.pygments .tok-gp { color: #000080; font-weight: bold } /* Generic.Prompt */
pre.pygments .tok-gs { font-weight: bold } /* Generic.Strong */
pre.pygments .tok-gu { color: #800080; font-weight: bold } /* Generic.Subheading */
pre.pygments .tok-gt { color: #0044DD } /* Generic.Traceback */
pre.pygments .tok-kc { color: #008000; font-weight: bold } /* Keyword.Constant */
pre.pygments .tok-kd { color: #008000; font-weight: bold } /* Keyword.Declaration */
pre.pygments .tok-kn { color: #008000; font-weight: bold } /* Keyword.Namespace */
pre.pygments .tok-kp { color: #008000 } /* Keyword.Pseudo */
pre.pygments .tok-kr { color: #008000; font-weight: bold } /* Keyword.Reserved */
pre.pygments .tok-kt { color: #B00040 } /* Keyword.Type */
pre.pygments .tok-m { color: #666666 } /* Literal.Number */
pre.pygments .tok-s { color: #BA2121 } /* Literal.String */
pre.pygments .tok-na { color: #7D9029 } /* Name.Attribute */
pre.pygments .tok-nb { color: #008000 } /* Name.Builtin */
pre.pygments .tok-nc { color: #0000FF; font-weight: bold } /* Name.Class */
pre.pygments .tok-no { color: #880000 } /* Name.Constant */
pre.pygments .tok-nd { color: #AA22FF } /* Name.Decorator */
pre.pygments .tok-ni { color: #999999; font-weight: bold } /* Name.Entity */
pre.pygments .tok-ne { color: #D2413A; font-weight: bold } /* Name.Exception */
pre.pygments .tok-nf { color: #0000FF } /* Name.Function */
pre.pygments .tok-nl { color: #A0A000 } /* Name.Label */
pre.pygments .tok-nn { color: #0000FF; font-weight: bold } /* Name.Namespace */
pre.pygments .tok-nt { color: #008000; font-weight: bold } /* Name.Tag */
pre.pygments .tok-nv { color: #19177C } /* Name.Variable */
pre.pygments .tok-ow { color: #AA22FF; font-weight: bold } /* Operator.Word */
pre.pygments .tok-w { color: #bbbbbb } /* Text.Whitespace */
pre.pygments .tok-mb { color: #666666 } /* Literal.Number.Bin */
pre.pygments .tok-mf { color: #666666 } /* Literal.Number.Float */
pre.pygments .tok-mh { color: #666666 } /* Literal.Number.Hex */
pre.pygments .tok-mi { color: #666666 } /* Literal.Number.Integer */
pre.pygments .tok-mo { color: #666666 } /* Literal.Number.Oct */
pre.pygments .tok-sa { color: #BA2121 } /* Literal.String.Affix */
pre.pygments .tok-sb { color: #BA2121 } /* Literal.String.Backtick */
pre.pygments .tok-sc { color: #BA2121 } /* Literal.String.Char */
pre.pygments .tok-dl { color: #BA2121 } /* Literal.String.Delimiter */
pre.pygments .tok-sd { color: #BA2121; font-style: italic } /* Literal.String.Doc */
pre.pygments .tok-s2 { color: #BA2121 } /* Literal.String.Double */
pre.pygments .tok-se { color: #BB6622; font-weight: bold } /* Literal.String.Escape */
pre.pygments .tok-sh { color: #BA2121 } /* Literal.String.Heredoc */
pre.pygments .tok-si { color: #BB6688; font-weight: bold } /* Literal.String.Interpol */
pre.pygments .tok-sx { color: #008000 } /* Literal.String.Other */
pre.pygments .tok-sr { color: #BB6688 } /* Literal.String.Regex */
pre.pygments .tok-s1 { color: #BA2121 } /* Literal.String.Single */
pre.pygments .tok-ss { color: #19177C } /* Literal.String.Symbol */
pre.pygments .tok-bp { color: #008000 } /* Name.Builtin.Pseudo */
pre.pygments .tok-fm { color: #0000FF } /* Name.Function.Magic */
pre.pygments .tok-vc { color: #19177C } /* Name.Variable.Class */
pre.pygments .tok-vg { color: #19177C } /* Name.Variable.Global */
pre.pygments .tok-vi { color: #19177C } /* Name.Variable.Instance */
pre.pygments .tok-vm { color: #19177C } /* Name.Variable.Magic */
pre.pygments .tok-il { color: #666666 } /* Literal.Number.Integer.Long */
</style>
</head>
<body class="article toc2 toc-left">
<div id="header">
<h1><a href="https://github.com/corva-ai/python-sdk">corva-sdk</a></h1>
<div id="toc" class="toc2">
<div id="toctitle">Table of Contents</div>
<ul class="sectlevel1">
<li><a href="#_install">1. Install</a></li>
<li><a href="#app_types">2. App Types</a>
<ul class="sectlevel2">
<li><a href="#stream">2.1. Stream</a>
<ul class="sectlevel3">
<li><a href="#stream_time">2.1.1. Time</a></li>
<li><a href="#stream_depth">2.1.2. Depth</a></li>
</ul>
</li>
<li><a href="#scheduled">2.2. Scheduled</a>
<ul class="sectlevel3">
<li><a href="#scheduled_time">2.2.1. Data Time</a></li>
<li><a href="#scheduled_depth">2.2.2. Depth</a></li>
<li><a href="#scheduled_natural">2.2.3. Natural Time</a></li>
</ul>
</li>
<li><a href="#task">2.3. Task</a></li>
</ul>
</li>
<li><a href="#event">3. Event</a></li>
<li><a href="#api">4. Api</a>
<ul class="sectlevel2">
<li><a href="#_url_usage">4.1. Url usage</a></li>
<li><a href="#_http_get">4.2. HTTP GET</a></li>
<li><a href="#_http_post_delete_put_and_patch">4.3. HTTP POST, DELETE, PUT and PATCH</a></li>
<li><a href="#_custom_headers_and_timeouts">4.4. Custom headers and timeouts</a></li>
<li><a href="#_convenience_methods">4.5. Convenience methods</a>
<ul class="sectlevel3">
<li><a href="#_get_dataset">4.5.1. Get dataset</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#cache">5. Cache</a>
<ul class="sectlevel2">
<li><a href="#_store_and_load">5.1. Store and load</a></li>
<li><a href="#_delete">5.2. Delete</a></li>
<li><a href="#_expiry_ttl_and_exists">5.3. Expiry, ttl and exists</a></li>
</ul>
</li>
<li><a href="#_logging">6. Logging</a>
<ul class="sectlevel2">
<li><a href="#_customizations">6.1. Customizations</a>
<ul class="sectlevel3">
<li><a href="#sentry">6.1.1. Sentry</a></li>
<li><a href="#rollbar">6.1.2. Rollbar</a></li>
<li><a href="#_raygun">6.1.3. Raygun</a></li>
<li><a href="#_other_libraries">6.1.4. Other libraries</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="#_secrets">7. Secrets</a></li>
<li><a href="#_testing">8. Testing</a>
<ul class="sectlevel2">
<li><a href="#_stream">8.1. Stream</a>
<ul class="sectlevel3">
<li><a href="#_time">8.1.1. Time</a></li>
<li><a href="#_depth">8.1.2. Depth</a></li>
</ul>
</li>
<li><a href="#_scheduled">8.2. Scheduled</a>
<ul class="sectlevel3">
<li><a href="#_data_time">8.2.1. Data Time</a></li>
<li><a href="#_depth_2">8.2.2. Depth</a></li>
<li><a href="#_natural_time">8.2.3. Natural Time</a></li>
</ul>
</li>
<li><a href="#_task">8.3. Task</a></li>
<li><a href="#testing_secrets">8.4. Secrets</a></li>
</ul>
</li>
<li><a href="#_development_contributing">9. Development - Contributing</a>
<ul class="sectlevel2">
<li><a href="#_create_and_activate_virtual_environment">9.1. Create and activate virtual environment</a></li>
<li><a href="#_install_dependencies_and_run_tests">9.2. Install dependencies and run tests</a></li>
<li><a href="#_whats_next">9.3. What&#8217;s next?</a></li>
</ul>
</li>
</ul>
</div>
</div>
<div id="content">
<div id="preamble">
<div class="sectionbody">
<div class="paragraph">
<p>Documentation for version <strong>v1.3.0</strong>.</p>
</div>
<div class="paragraph">
<p><strong>corva-sdk</strong> is a framework for building <a href="https://app.corva.ai/dev-center/docs">Corva DevCenter</a> Python apps.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_install">1. Install</h2>
<div class="sectionbody">
<div class="paragraph">
<p><strong>corva-sdk</strong> requires Python 3.8.</p>
</div>
<div class="paragraph">
<p>Installation is as simple as:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="bash"><span></span>pip install corva-sdk</code></pre>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="app_types">2. App Types</h2>
<div class="sectionbody">
<div class="paragraph">
<p>There are three app types that you can build:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p><a href="#stream"><code>stream</code></a> - works with real-time data.</p>
</li>
<li>
<p><a href="#scheduled"><code>scheduled</code></a> - works with data at defined schedules/intervals
(e.g., once a minute, once every 3 ft.).</p>
</li>
<li>
<p><a href="#task"><code>task</code></a> - works with data on-demand.</p>
</li>
</ol>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
Use type hints like in examples below
for better support from editors and tools.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="stream">2.1. Stream</h3>
<div class="paragraph">
<p>Stream apps can be
<a href="#stream_time">time</a> or <a href="#stream_depth">depth</a> based.</p>
</div>
<div class="sect3">
<h4 id="stream_time">2.1.1. Time</h4>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span></span><span class="tok-kn">from</span> <span class="tok-nn">corva</span> <span class="tok-kn">import</span> <span class="tok-n">Api</span><span class="tok-p">,</span> <span class="tok-n">Cache</span><span class="tok-p">,</span> <span class="tok-n">StreamTimeEvent</span><span class="tok-p">,</span> <span class="tok-n">stream</span>  <i class="conum" data-value="1"></i><b>(1)</b>


<span class="tok-nd">@stream</span>  <i class="conum" data-value="3"></i><b>(3)</b>
<span class="tok-k">def</span> <span class="tok-nf">stream_time_app</span><span class="tok-p">(</span><span class="tok-n">event</span><span class="tok-p">:</span> <span class="tok-n">StreamTimeEvent</span><span class="tok-p">,</span> <span class="tok-n">api</span><span class="tok-p">:</span> <span class="tok-n">Api</span><span class="tok-p">,</span> <span class="tok-n">cache</span><span class="tok-p">:</span> <span class="tok-n">Cache</span><span class="tok-p">):</span>  <i class="conum" data-value="2"></i><b>(2)</b>
    <span class="tok-k">return</span> <span class="tok-s2">&quot;Hello, World!&quot;</span>  <i class="conum" data-value="4"></i><b>(4)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Import required functionality.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Define your function. It must receive three argumets: <a href="#event">event</a>, <a href="#api">api</a> and <a href="#cache">cache</a>. The arguments serve as building blocks for your app.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Decorate your function using <code>stream</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Add app logic here.</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="stream_depth">2.1.2. Depth</h4>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span></span><span class="tok-kn">from</span> <span class="tok-nn">corva</span> <span class="tok-kn">import</span> <span class="tok-n">Api</span><span class="tok-p">,</span> <span class="tok-n">Cache</span><span class="tok-p">,</span> <span class="tok-n">StreamDepthEvent</span><span class="tok-p">,</span> <span class="tok-n">stream</span>  <i class="conum" data-value="1"></i><b>(1)</b>


<span class="tok-nd">@stream</span>  <i class="conum" data-value="3"></i><b>(3)</b>
<span class="tok-k">def</span> <span class="tok-nf">stream_depth_app</span><span class="tok-p">(</span><span class="tok-n">event</span><span class="tok-p">:</span> <span class="tok-n">StreamDepthEvent</span><span class="tok-p">,</span> <span class="tok-n">api</span><span class="tok-p">:</span> <span class="tok-n">Api</span><span class="tok-p">,</span> <span class="tok-n">cache</span><span class="tok-p">:</span> <span class="tok-n">Cache</span><span class="tok-p">):</span>  <i class="conum" data-value="2"></i><b>(2)</b>
    <span class="tok-k">return</span> <span class="tok-s1">&#39;Hello, World!&#39;</span>  <i class="conum" data-value="4"></i><b>(4)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Import required functionality.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Define your function. It must receive three argumets: <a href="#event">event</a>, <a href="#api">api</a> and <a href="#cache">cache</a>. The arguments serve as building blocks for your app.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Decorate your function using <code>stream</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Add app logic here.</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="scheduled">2.2. Scheduled</h3>
<div class="paragraph">
<p>Scheduled apps can be
<a href="#scheduled_time">data time</a>,
<a href="#scheduled_depth">depth</a>
or <a href="#scheduled_natural">natural time</a> based.</p>
</div>
<div class="sect3">
<h4 id="scheduled_time">2.2.1. Data Time</h4>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span></span><span class="tok-kn">from</span> <span class="tok-nn">corva</span> <span class="tok-kn">import</span> <span class="tok-n">Api</span><span class="tok-p">,</span> <span class="tok-n">Cache</span><span class="tok-p">,</span> <span class="tok-n">ScheduledDataTimeEvent</span><span class="tok-p">,</span> <span class="tok-n">scheduled</span>  <i class="conum" data-value="1"></i><b>(1)</b>


<span class="tok-nd">@scheduled</span>  <i class="conum" data-value="3"></i><b>(3)</b>
<span class="tok-k">def</span> <span class="tok-nf">scheduled_app</span><span class="tok-p">(</span><span class="tok-n">event</span><span class="tok-p">:</span> <span class="tok-n">ScheduledDataTimeEvent</span><span class="tok-p">,</span> <span class="tok-n">api</span><span class="tok-p">:</span> <span class="tok-n">Api</span><span class="tok-p">,</span> <span class="tok-n">cache</span><span class="tok-p">:</span> <span class="tok-n">Cache</span><span class="tok-p">):</span>  <i class="conum" data-value="2"></i><b>(2)</b>
    <span class="tok-k">return</span> <span class="tok-s1">&#39;Hello, World!&#39;</span>  <i class="conum" data-value="4"></i><b>(4)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Import required functionality.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Define your function. It must receive three argumets: <a href="#event">event</a>, <a href="#api">api</a> and <a href="#cache">cache</a>. The arguments serve as building blocks for your app.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Decorate your function using <code>scheduled</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Add app logic here.</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="scheduled_depth">2.2.2. Depth</h4>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span></span><span class="tok-kn">from</span> <span class="tok-nn">corva</span> <span class="tok-kn">import</span> <span class="tok-n">Api</span><span class="tok-p">,</span> <span class="tok-n">Cache</span><span class="tok-p">,</span> <span class="tok-n">ScheduledDepthEvent</span><span class="tok-p">,</span> <span class="tok-n">scheduled</span>  <i class="conum" data-value="1"></i><b>(1)</b>


<span class="tok-nd">@scheduled</span>  <i class="conum" data-value="3"></i><b>(3)</b>
<span class="tok-k">def</span> <span class="tok-nf">scheduled_app</span><span class="tok-p">(</span><span class="tok-n">event</span><span class="tok-p">:</span> <span class="tok-n">ScheduledDepthEvent</span><span class="tok-p">,</span> <span class="tok-n">api</span><span class="tok-p">:</span> <span class="tok-n">Api</span><span class="tok-p">,</span> <span class="tok-n">cache</span><span class="tok-p">:</span> <span class="tok-n">Cache</span><span class="tok-p">):</span>  <i class="conum" data-value="2"></i><b>(2)</b>
    <span class="tok-k">return</span> <span class="tok-s1">&#39;Hello, World!&#39;</span>  <i class="conum" data-value="4"></i><b>(4)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Import required functionality.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Define your function. It must receive three argumets: <a href="#event">event</a>, <a href="#api">api</a> and <a href="#cache">cache</a>. The arguments serve as building blocks for your app.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Decorate your function using <code>scheduled</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Add app logic here.</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="scheduled_natural">2.2.3. Natural Time</h4>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span></span><span class="tok-kn">from</span> <span class="tok-nn">corva</span> <span class="tok-kn">import</span> <span class="tok-n">Api</span>  <i class="conum" data-value="1"></i><b>(1)</b>
<span class="tok-kn">from</span> <span class="tok-nn">corva</span> <span class="tok-kn">import</span> <span class="tok-n">Cache</span><span class="tok-p">,</span> <span class="tok-n">ScheduledNaturalTimeEvent</span><span class="tok-p">,</span> <span class="tok-n">scheduled</span>


<span class="tok-nd">@scheduled</span>  <i class="conum" data-value="3"></i><b>(3)</b>
<span class="tok-k">def</span> <span class="tok-nf">scheduled_app</span><span class="tok-p">(</span><span class="tok-n">event</span><span class="tok-p">:</span> <span class="tok-n">ScheduledNaturalTimeEvent</span><span class="tok-p">,</span> <span class="tok-n">api</span><span class="tok-p">:</span> <span class="tok-n">Api</span><span class="tok-p">,</span> <span class="tok-n">cache</span><span class="tok-p">:</span> <span class="tok-n">Cache</span><span class="tok-p">):</span>  <i class="conum" data-value="2"></i><b>(2)</b>
    <span class="tok-k">return</span> <span class="tok-s1">&#39;Hello, World!&#39;</span>  <i class="conum" data-value="4"></i><b>(4)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Import required functionality.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Define your function. It must receive three argumets: <a href="#event">event</a>, <a href="#api">api</a> and <a href="#cache">cache</a>. The arguments serve as building blocks for your app.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Decorate your function using <code>scheduled</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Add app logic here.</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="task">2.3. Task</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span></span><span class="tok-kn">from</span> <span class="tok-nn">corva</span> <span class="tok-kn">import</span> <span class="tok-n">Api</span><span class="tok-p">,</span> <span class="tok-n">TaskEvent</span><span class="tok-p">,</span> <span class="tok-n">task</span>  <i class="conum" data-value="1"></i><b>(1)</b>


<span class="tok-nd">@task</span>  <i class="conum" data-value="3"></i><b>(3)</b>
<span class="tok-k">def</span> <span class="tok-nf">task_app</span><span class="tok-p">(</span><span class="tok-n">event</span><span class="tok-p">:</span> <span class="tok-n">TaskEvent</span><span class="tok-p">,</span> <span class="tok-n">api</span><span class="tok-p">:</span> <span class="tok-n">Api</span><span class="tok-p">):</span>  <i class="conum" data-value="2"></i><b>(2)</b>
    <span class="tok-k">return</span> <span class="tok-s1">&#39;Hello, World!&#39;</span>  <i class="conum" data-value="4"></i><b>(4)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Import required functionality.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Define your function.
It must receive two argumets:
<a href="#event">event</a> and <a href="#api">api</a>.
The arguments serve as building blocks for your app.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Decorate your function using <code>task</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Add app logic here.</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="event">3. Event</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Event is an object that contains essential data for the app.
Each <a href="#app_types">app type</a> has its corresponding event type,
which only contains fields relevant to that app.</p>
</div>
</div>
</div>
<div class="sect1">
<h2 id="api">4. Api</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Apps should be able to communicate with
<a href="https://api.corva.ai/documentation/index.html">Corva Platform API</a> and <a href="https://data.corva.ai/docs#/">Corva Data API</a>.
For this <strong>corva-sdk</strong> provides an <code>Api</code> object,
which wraps Python <code>requests</code> library
and adds automatic authorization, convenient URL usage
and reasonable timeouts to API requests.
<code>Api</code> methods return <code>requests.Response</code> objects.</p>
</div>
<div class="sect2">
<h3 id="_url_usage">4.1. Url usage</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span></span><span class="tok-kn">from</span> <span class="tok-nn">corva</span> <span class="tok-kn">import</span> <span class="tok-n">Api</span><span class="tok-p">,</span> <span class="tok-n">TaskEvent</span><span class="tok-p">,</span> <span class="tok-n">task</span>


<span class="tok-nd">@task</span>
<span class="tok-k">def</span> <span class="tok-nf">task_app</span><span class="tok-p">(</span><span class="tok-n">event</span><span class="tok-p">:</span> <span class="tok-n">TaskEvent</span><span class="tok-p">,</span> <span class="tok-n">api</span><span class="tok-p">:</span> <span class="tok-n">Api</span><span class="tok-p">):</span>
    <span class="tok-n">api</span><span class="tok-o">.</span><span class="tok-n">get</span><span class="tok-p">(</span><span class="tok-s1">&#39;/v2/pads&#39;</span><span class="tok-p">)</span>  <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="tok-n">api</span><span class="tok-o">.</span><span class="tok-n">get</span><span class="tok-p">(</span><span class="tok-s1">&#39;/api/v1/data/provider/dataset/&#39;</span><span class="tok-p">)</span>  <i class="conum" data-value="2"></i><b>(2)</b>
    <span class="tok-n">api</span><span class="tok-o">.</span><span class="tok-n">get</span><span class="tok-p">(</span><span class="tok-s1">&#39;https://api.corva.ai/v2/pads&#39;</span><span class="tok-p">)</span>  <i class="conum" data-value="3"></i><b>(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Use <a href="https://api.corva.ai/documentation/index.html">Corva Platform API</a> URL suffix
to make a Platform API call.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Use <a href="https://data.corva.ai/docs#/">Corva Data API</a> URL suffix
to make a Data API call.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>You can also provide full URL.</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_http_get">4.2. HTTP GET</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span></span><span class="tok-kn">from</span> <span class="tok-nn">corva</span> <span class="tok-kn">import</span> <span class="tok-n">Api</span><span class="tok-p">,</span> <span class="tok-n">TaskEvent</span><span class="tok-p">,</span> <span class="tok-n">task</span>


<span class="tok-nd">@task</span>
<span class="tok-k">def</span> <span class="tok-nf">task_app</span><span class="tok-p">(</span><span class="tok-n">event</span><span class="tok-p">:</span> <span class="tok-n">TaskEvent</span><span class="tok-p">,</span> <span class="tok-n">api</span><span class="tok-p">:</span> <span class="tok-n">Api</span><span class="tok-p">):</span>
    <span class="tok-n">response</span> <span class="tok-o">=</span> <span class="tok-n">api</span><span class="tok-o">.</span><span class="tok-n">get</span><span class="tok-p">(</span><span class="tok-s1">&#39;/v2/pads&#39;</span><span class="tok-p">)</span>  <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="tok-n">api</span><span class="tok-o">.</span><span class="tok-n">get</span><span class="tok-p">(</span><span class="tok-s1">&#39;/v2/pads&#39;</span><span class="tok-p">,</span> <span class="tok-n">params</span><span class="tok-o">=</span><span class="tok-p">{</span><span class="tok-s1">&#39;company&#39;</span><span class="tok-p">:</span> <span class="tok-mi">1</span><span class="tok-p">})</span>  <i class="conum" data-value="2"></i><b>(2)</b>

    <span class="tok-n">response</span><span class="tok-o">.</span><span class="tok-n">json</span><span class="tok-p">()</span>  <i class="conum" data-value="3"></i><b>(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Simplest GET example.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Use optional <code>params</code> parameter
to provide URL query string params.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>You can unpack received data like this,
as all <code>Api</code> methods return <code>requests.Response</code> objects.</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_http_post_delete_put_and_patch">4.3. HTTP POST, DELETE, PUT and PATCH</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span></span><span class="tok-kn">from</span> <span class="tok-nn">corva</span> <span class="tok-kn">import</span> <span class="tok-n">Api</span><span class="tok-p">,</span> <span class="tok-n">TaskEvent</span><span class="tok-p">,</span> <span class="tok-n">task</span>


<span class="tok-nd">@task</span>
<span class="tok-k">def</span> <span class="tok-nf">task_app</span><span class="tok-p">(</span><span class="tok-n">event</span><span class="tok-p">:</span> <span class="tok-n">TaskEvent</span><span class="tok-p">,</span> <span class="tok-n">api</span><span class="tok-p">:</span> <span class="tok-n">Api</span><span class="tok-p">):</span>
    <span class="tok-n">api</span><span class="tok-o">.</span><span class="tok-n">post</span><span class="tok-p">(</span><span class="tok-s1">&#39;/v2/pads&#39;</span><span class="tok-p">,</span> <span class="tok-n">data</span><span class="tok-o">=</span><span class="tok-p">{</span><span class="tok-s1">&#39;key&#39;</span><span class="tok-p">:</span> <span class="tok-s1">&#39;val&#39;</span><span class="tok-p">})</span>   <i class="conum" data-value="1"></i><b>(1)</b> <i class="conum" data-value="5"></i><b>(5)</b>
    <span class="tok-n">api</span><span class="tok-o">.</span><span class="tok-n">delete</span><span class="tok-p">(</span><span class="tok-s1">&#39;/v2/pads/123&#39;</span><span class="tok-p">)</span>  <i class="conum" data-value="2"></i><b>(2)</b>
    <span class="tok-n">api</span><span class="tok-o">.</span><span class="tok-n">put</span><span class="tok-p">(</span><span class="tok-s1">&#39;/api/v1/data/provider/dataset/&#39;</span><span class="tok-p">,</span> <span class="tok-n">data</span><span class="tok-o">=</span><span class="tok-p">{</span><span class="tok-s1">&#39;key&#39;</span><span class="tok-p">:</span> <span class="tok-s1">&#39;val&#39;</span><span class="tok-p">})</span>   <i class="conum" data-value="3"></i><b>(3)</b> <i class="conum" data-value="5"></i><b>(5)</b>
    <span class="tok-n">api</span><span class="tok-o">.</span><span class="tok-n">patch</span><span class="tok-p">(</span><span class="tok-s1">&#39;/v2/pads/123&#39;</span><span class="tok-p">,</span> <span class="tok-n">data</span><span class="tok-o">=</span><span class="tok-p">{</span><span class="tok-s1">&#39;key&#39;</span><span class="tok-p">:</span> <span class="tok-s1">&#39;val&#39;</span><span class="tok-p">})</span>   <i class="conum" data-value="4"></i><b>(4)</b> <i class="conum" data-value="5"></i><b>(5)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Simplest POST example.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Simplest DELETE example.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Simplest PUT example.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Simplest PATCH example.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Use <code>data</code> parameter
to provide a request body,
that will be casted to json.</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_custom_headers_and_timeouts">4.4. Custom headers and timeouts</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span></span><span class="tok-kn">from</span> <span class="tok-nn">corva</span> <span class="tok-kn">import</span> <span class="tok-n">Api</span><span class="tok-p">,</span> <span class="tok-n">TaskEvent</span><span class="tok-p">,</span> <span class="tok-n">task</span>


<span class="tok-nd">@task</span>
<span class="tok-k">def</span> <span class="tok-nf">task_app</span><span class="tok-p">(</span><span class="tok-n">event</span><span class="tok-p">:</span> <span class="tok-n">TaskEvent</span><span class="tok-p">,</span> <span class="tok-n">api</span><span class="tok-p">:</span> <span class="tok-n">Api</span><span class="tok-p">):</span>
    <span class="tok-n">api</span><span class="tok-o">.</span><span class="tok-n">get</span><span class="tok-p">(</span><span class="tok-s1">&#39;/v2/pads&#39;</span><span class="tok-p">,</span> <span class="tok-n">headers</span><span class="tok-o">=</span><span class="tok-p">{</span><span class="tok-s1">&#39;header&#39;</span><span class="tok-p">:</span> <span class="tok-s1">&#39;header-value&#39;</span><span class="tok-p">})</span>  <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="tok-n">api</span><span class="tok-o">.</span><span class="tok-n">get</span><span class="tok-p">(</span><span class="tok-s1">&#39;/v2/pads&#39;</span><span class="tok-p">,</span> <span class="tok-n">timeout</span><span class="tok-o">=</span><span class="tok-mi">5</span><span class="tok-p">)</span>  <i class="conum" data-value="2"></i><b>(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Use <code>headers</code> parameter
to add custom headers to the request.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Use <code>timeout</code> parameter
to override default timeout value.</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_convenience_methods">4.5. Convenience methods</h3>
<div class="paragraph">
<p><code>Api</code> provides some convenience methods
for frequently used endpoints.</p>
</div>
<div class="sect3">
<h4 id="_get_dataset">4.5.1. Get dataset</h4>
<div class="paragraph">
<p>Fetch the data from the
<a href="https://data.corva.ai/docs#/default/index_api_v1_data__provider___dataset___get">/api/v1/data/provider/dataset/</a> endpoint
using <code>Api.get_dataset</code> method.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span></span><span class="tok-kn">from</span> <span class="tok-nn">corva</span> <span class="tok-kn">import</span> <span class="tok-n">Api</span><span class="tok-p">,</span> <span class="tok-n">TaskEvent</span><span class="tok-p">,</span> <span class="tok-n">task</span>


<span class="tok-nd">@task</span>
<span class="tok-k">def</span> <span class="tok-nf">task_app</span><span class="tok-p">(</span><span class="tok-n">event</span><span class="tok-p">:</span> <span class="tok-n">TaskEvent</span><span class="tok-p">,</span> <span class="tok-n">api</span><span class="tok-p">:</span> <span class="tok-n">Api</span><span class="tok-p">):</span>
    <span class="tok-n">api</span><span class="tok-o">.</span><span class="tok-n">get_dataset</span><span class="tok-p">(</span>
        <span class="tok-n">provider</span><span class="tok-o">=</span><span class="tok-s1">&#39;corva&#39;</span><span class="tok-p">,</span>
        <span class="tok-n">dataset</span><span class="tok-o">=</span><span class="tok-s1">&#39;wits&#39;</span><span class="tok-p">,</span>
        <span class="tok-n">query</span><span class="tok-o">=</span><span class="tok-p">{</span>
            <span class="tok-s1">&#39;asset_id&#39;</span><span class="tok-p">:</span> <span class="tok-n">event</span><span class="tok-o">.</span><span class="tok-n">asset_id</span><span class="tok-p">,</span>
        <span class="tok-p">},</span>
        <span class="tok-n">sort</span><span class="tok-o">=</span><span class="tok-p">{</span><span class="tok-s1">&#39;timestamp&#39;</span><span class="tok-p">:</span> <span class="tok-mi">1</span><span class="tok-p">},</span>
        <span class="tok-n">limit</span><span class="tok-o">=</span><span class="tok-mi">1</span><span class="tok-p">,</span>
        <span class="tok-n">fields</span><span class="tok-o">=</span><span class="tok-s1">&#39;data,metadata&#39;</span><span class="tok-p">,</span>
    <span class="tok-p">)</span></code></pre>
</div>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="cache">5. Cache</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Apps might need to share some data between invokes.
For this <strong>corva-sdk</strong> provides a <code>Cache</code> object.
<code>Cache</code> uses a dict-like database,
so the data is stored as <code>key:value</code> pairs.</p>
</div>
<div class="paragraph">
<p>A typical example of <code>Cache</code> usage is:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Store some data during <code>app invoke 1</code>.</p>
</li>
<li>
<p>Retrieve and use the data during <code>app invoke 2</code>.</p>
</li>
</ol>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>To get the most out of <code>Cache</code>:</p>
</div>
<div class="olist arabic">
<ol class="arabic">
<li>
<p>Store as small amounts of data as possible.</p>
</li>
<li>
<p>Try to stay below <code>100kb</code>.</p>
</li>
</ol>
</div>
</td>
</tr>
</table>
</div>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
<a href="#task">Task</a> apps don&#8217;t get a <code>Cache</code> parameter
as they aren&#8217;t meant to share the data between invokes.
</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_store_and_load">5.1. Store and load</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span></span><span class="tok-kn">from</span> <span class="tok-nn">corva</span> <span class="tok-kn">import</span> <span class="tok-n">Api</span><span class="tok-p">,</span> <span class="tok-n">Cache</span><span class="tok-p">,</span> <span class="tok-n">ScheduledDataTimeEvent</span><span class="tok-p">,</span> <span class="tok-n">scheduled</span>


<span class="tok-nd">@scheduled</span>
<span class="tok-k">def</span> <span class="tok-nf">scheduled_app</span><span class="tok-p">(</span><span class="tok-n">event</span><span class="tok-p">:</span> <span class="tok-n">ScheduledDataTimeEvent</span><span class="tok-p">,</span> <span class="tok-n">api</span><span class="tok-p">:</span> <span class="tok-n">Api</span><span class="tok-p">,</span> <span class="tok-n">cache</span><span class="tok-p">:</span> <span class="tok-n">Cache</span><span class="tok-p">):</span>
    <span class="tok-n">cache</span><span class="tok-o">.</span><span class="tok-n">store</span><span class="tok-p">(</span><span class="tok-n">key</span><span class="tok-o">=</span><span class="tok-s1">&#39;key&#39;</span><span class="tok-p">,</span> <span class="tok-n">value</span><span class="tok-o">=</span><span class="tok-s1">&#39;&#39;</span><span class="tok-p">)</span>  <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="tok-k">assert</span> <span class="tok-n">cache</span><span class="tok-o">.</span><span class="tok-n">load</span><span class="tok-p">(</span><span class="tok-n">key</span><span class="tok-o">=</span><span class="tok-s1">&#39;key&#39;</span><span class="tok-p">)</span> <span class="tok-o">==</span> <span class="tok-s1">&#39;&#39;</span>  <i class="conum" data-value="2"></i><b>(2)</b>

    <span class="tok-n">cache</span><span class="tok-o">.</span><span class="tok-n">store</span><span class="tok-p">(</span><span class="tok-n">key</span><span class="tok-o">=</span><span class="tok-s1">&#39;key&#39;</span><span class="tok-p">,</span> <span class="tok-n">value</span><span class="tok-o">=</span><span class="tok-mi">0</span><span class="tok-p">)</span>  <i class="conum" data-value="3"></i><b>(3)</b>
    <span class="tok-k">assert</span> <span class="tok-n">cache</span><span class="tok-o">.</span><span class="tok-n">load</span><span class="tok-p">(</span><span class="tok-n">key</span><span class="tok-o">=</span><span class="tok-s1">&#39;key&#39;</span><span class="tok-p">)</span> <span class="tok-o">==</span> <span class="tok-s1">&#39;0&#39;</span>  <i class="conum" data-value="4"></i><b>(4)</b>

    <span class="tok-n">cache</span><span class="tok-o">.</span><span class="tok-n">store</span><span class="tok-p">(</span><span class="tok-n">key</span><span class="tok-o">=</span><span class="tok-s1">&#39;key&#39;</span><span class="tok-p">,</span> <span class="tok-n">value</span><span class="tok-o">=</span><span class="tok-mf">0.0</span><span class="tok-p">)</span>  <i class="conum" data-value="5"></i><b>(5)</b>
    <span class="tok-k">assert</span> <span class="tok-n">cache</span><span class="tok-o">.</span><span class="tok-n">load</span><span class="tok-p">(</span><span class="tok-n">key</span><span class="tok-o">=</span><span class="tok-s1">&#39;key&#39;</span><span class="tok-p">)</span> <span class="tok-o">==</span> <span class="tok-s1">&#39;0.0&#39;</span>  <i class="conum" data-value="4"></i><b>(4)</b>

    <span class="tok-n">cache</span><span class="tok-o">.</span><span class="tok-n">store</span><span class="tok-p">(</span><span class="tok-n">key</span><span class="tok-o">=</span><span class="tok-s1">&#39;key&#39;</span><span class="tok-p">,</span> <span class="tok-n">value</span><span class="tok-o">=</span><span class="tok-sa">b</span><span class="tok-s1">&#39;&#39;</span><span class="tok-p">)</span>  <i class="conum" data-value="6"></i><b>(6)</b>
    <span class="tok-k">assert</span> <span class="tok-n">cache</span><span class="tok-o">.</span><span class="tok-n">load</span><span class="tok-p">(</span><span class="tok-n">key</span><span class="tok-o">=</span><span class="tok-s1">&#39;key&#39;</span><span class="tok-p">)</span> <span class="tok-o">==</span> <span class="tok-s1">&#39;&#39;</span>  <i class="conum" data-value="4"></i><b>(4)</b>

    <span class="tok-n">cache</span><span class="tok-o">.</span><span class="tok-n">store</span><span class="tok-p">(</span><span class="tok-n">mapping</span><span class="tok-o">=</span><span class="tok-p">{</span><span class="tok-s1">&#39;key&#39;</span><span class="tok-p">:</span> <span class="tok-s1">&#39;val&#39;</span><span class="tok-p">,</span> <span class="tok-s1">&#39;other-key&#39;</span><span class="tok-p">:</span> <span class="tok-s1">&#39;other-val&#39;</span><span class="tok-p">})</span>  <i class="conum" data-value="7"></i><b>(7)</b>
    <span class="tok-k">assert</span> <span class="tok-n">cache</span><span class="tok-o">.</span><span class="tok-n">load_all</span><span class="tok-p">()</span> <span class="tok-o">==</span> <span class="tok-p">{</span><span class="tok-s1">&#39;key&#39;</span><span class="tok-p">:</span> <span class="tok-s1">&#39;val&#39;</span><span class="tok-p">,</span> <span class="tok-s1">&#39;other-key&#39;</span><span class="tok-p">:</span> <span class="tok-s1">&#39;other-val&#39;</span><span class="tok-p">}</span>  <i class="conum" data-value="8"></i><b>(8)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td><code>Cache</code> can store <code>str</code> values.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Load the value using its key.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td><code>Cache</code> can store <code>int</code> values.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td><code>Cache</code> stores the values in binary format.
The data is decoded while loading,
but <code>Cache</code> can&#8217;t assume the type of the value.
That&#8217;s why the returned type is <code>str</code>.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td><code>Cache</code> can store <code>float</code> values.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td><code>Cache</code> can store <code>bytes</code> values.</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>Store multiple values at once using <code>mapping</code> parameter.</td>
</tr>
<tr>
<td><i class="conum" data-value="8"></i><b>8</b></td>
<td>Load all data from cache.</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_delete">5.2. Delete</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span></span><span class="tok-kn">from</span> <span class="tok-nn">corva</span> <span class="tok-kn">import</span> <span class="tok-n">Api</span><span class="tok-p">,</span> <span class="tok-n">Cache</span><span class="tok-p">,</span> <span class="tok-n">ScheduledDataTimeEvent</span><span class="tok-p">,</span> <span class="tok-n">scheduled</span>


<span class="tok-nd">@scheduled</span>
<span class="tok-k">def</span> <span class="tok-nf">scheduled_app</span><span class="tok-p">(</span><span class="tok-n">event</span><span class="tok-p">:</span> <span class="tok-n">ScheduledDataTimeEvent</span><span class="tok-p">,</span> <span class="tok-n">api</span><span class="tok-p">:</span> <span class="tok-n">Api</span><span class="tok-p">,</span> <span class="tok-n">cache</span><span class="tok-p">:</span> <span class="tok-n">Cache</span><span class="tok-p">):</span>
    <span class="tok-n">cache</span><span class="tok-o">.</span><span class="tok-n">store</span><span class="tok-p">(</span><span class="tok-n">mapping</span><span class="tok-o">=</span><span class="tok-p">{</span><span class="tok-s1">&#39;key1&#39;</span><span class="tok-p">:</span> <span class="tok-s1">&#39;val1&#39;</span><span class="tok-p">,</span> <span class="tok-s1">&#39;key2&#39;</span><span class="tok-p">:</span> <span class="tok-s1">&#39;val2&#39;</span><span class="tok-p">,</span> <span class="tok-s1">&#39;key3&#39;</span><span class="tok-p">:</span> <span class="tok-s1">&#39;val3&#39;</span><span class="tok-p">})</span>  <i class="conum" data-value="1"></i><b>(1)</b>

    <span class="tok-n">cache</span><span class="tok-o">.</span><span class="tok-n">delete</span><span class="tok-p">(</span><span class="tok-n">keys</span><span class="tok-o">=</span><span class="tok-p">[</span><span class="tok-s1">&#39;key1&#39;</span><span class="tok-p">])</span>  <i class="conum" data-value="2"></i><b>(2)</b>
    <span class="tok-k">assert</span> <span class="tok-n">cache</span><span class="tok-o">.</span><span class="tok-n">load_all</span><span class="tok-p">()</span> <span class="tok-o">==</span> <span class="tok-p">{</span><span class="tok-s1">&#39;key2&#39;</span><span class="tok-p">:</span> <span class="tok-s1">&#39;val2&#39;</span><span class="tok-p">,</span> <span class="tok-s1">&#39;key3&#39;</span><span class="tok-p">:</span> <span class="tok-s1">&#39;val3&#39;</span><span class="tok-p">}</span>  <i class="conum" data-value="3"></i><b>(3)</b>

    <span class="tok-n">cache</span><span class="tok-o">.</span><span class="tok-n">delete_all</span><span class="tok-p">()</span>  <i class="conum" data-value="4"></i><b>(4)</b>
    <span class="tok-k">assert</span> <span class="tok-n">cache</span><span class="tok-o">.</span><span class="tok-n">load_all</span><span class="tok-p">()</span> <span class="tok-o">==</span> <span class="tok-p">{}</span>  <i class="conum" data-value="5"></i><b>(5)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Store some data.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Delete specific key.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Deleted key is not present in cache.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Delete all keys.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Cache is empty.</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_expiry_ttl_and_exists">5.3. Expiry, ttl and exists</h3>
<div class="admonitionblock note">
<table>
<tr>
<td class="icon">
<i class="fa icon-note" title="Note"></i>
</td>
<td class="content">
By default <code>Cache</code> sets an expiry to <code>60</code> days.
</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span></span><span class="tok-kn">import</span> <span class="tok-nn">datetime</span>
<span class="tok-kn">import</span> <span class="tok-nn">time</span>

<span class="tok-kn">from</span> <span class="tok-nn">corva</span> <span class="tok-kn">import</span> <span class="tok-n">Api</span><span class="tok-p">,</span> <span class="tok-n">Cache</span><span class="tok-p">,</span> <span class="tok-n">ScheduledDataTimeEvent</span><span class="tok-p">,</span> <span class="tok-n">scheduled</span>


<span class="tok-nd">@scheduled</span>
<span class="tok-k">def</span> <span class="tok-nf">scheduled_app</span><span class="tok-p">(</span><span class="tok-n">event</span><span class="tok-p">:</span> <span class="tok-n">ScheduledDataTimeEvent</span><span class="tok-p">,</span> <span class="tok-n">api</span><span class="tok-p">:</span> <span class="tok-n">Api</span><span class="tok-p">,</span> <span class="tok-n">cache</span><span class="tok-p">:</span> <span class="tok-n">Cache</span><span class="tok-p">):</span>
    <span class="tok-n">cache</span><span class="tok-o">.</span><span class="tok-n">store</span><span class="tok-p">(</span><span class="tok-n">key</span><span class="tok-o">=</span><span class="tok-s1">&#39;key&#39;</span><span class="tok-p">,</span> <span class="tok-n">value</span><span class="tok-o">=</span><span class="tok-s1">&#39;val&#39;</span><span class="tok-p">,</span> <span class="tok-n">expiry</span><span class="tok-o">=</span><span class="tok-mi">60</span><span class="tok-p">)</span>  <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="tok-n">cache</span><span class="tok-o">.</span><span class="tok-n">store</span><span class="tok-p">(</span><span class="tok-n">key</span><span class="tok-o">=</span><span class="tok-s1">&#39;key&#39;</span><span class="tok-p">,</span> <span class="tok-n">value</span><span class="tok-o">=</span><span class="tok-s1">&#39;val&#39;</span><span class="tok-p">,</span> <span class="tok-n">expiry</span><span class="tok-o">=</span><span class="tok-n">datetime</span><span class="tok-o">.</span><span class="tok-n">timedelta</span><span class="tok-p">(</span><span class="tok-n">seconds</span><span class="tok-o">=</span><span class="tok-mi">60</span><span class="tok-p">))</span>  <i class="conum" data-value="2"></i><b>(2)</b>

    <span class="tok-k">assert</span> <span class="tok-n">cache</span><span class="tok-o">.</span><span class="tok-n">ttl</span><span class="tok-p">()</span> <span class="tok-o">==</span> <span class="tok-mi">60</span>  <i class="conum" data-value="3"></i><b>(3)</b>
    <span class="tok-k">assert</span> <span class="tok-n">cache</span><span class="tok-o">.</span><span class="tok-n">pttl</span><span class="tok-p">()</span> <span class="tok-o">==</span> <span class="tok-mi">60000</span>  <i class="conum" data-value="4"></i><b>(4)</b>
    <span class="tok-k">assert</span> <span class="tok-n">cache</span><span class="tok-o">.</span><span class="tok-n">exists</span><span class="tok-p">()</span>  <i class="conum" data-value="5"></i><b>(5)</b>

    <span class="tok-n">time</span><span class="tok-o">.</span><span class="tok-n">sleep</span><span class="tok-p">(</span><span class="tok-mi">60</span><span class="tok-p">)</span>  <i class="conum" data-value="6"></i><b>(6)</b>

    <span class="tok-k">assert</span> <span class="tok-ow">not</span> <span class="tok-n">cache</span><span class="tok-o">.</span><span class="tok-n">exists</span><span class="tok-p">()</span>  <i class="conum" data-value="7"></i><b>(7)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Store the value and set an expiry to <code>60</code> seconds
using <code>expiry</code> parameter.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>expiry</code> parameter also supports
<code>datetime.timedelta</code> objects.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Get the remaining time of key expiry in seconds.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Get the remaining time of key expiry in milliseconds.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Verify, that cache contains some data.</td>
</tr>
<tr>
<td><i class="conum" data-value="6"></i><b>6</b></td>
<td>Wait for 60 seconds for data to expire.</td>
</tr>
<tr>
<td><i class="conum" data-value="7"></i><b>7</b></td>
<td>Verify, that cache is empty.</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_logging">6. Logging</h2>
<div class="sectionbody">
<div class="paragraph">
<p>As apps are executed very frequently
(once a second or so),
unlimited logging can lead to huge amounts of data.
<strong>corva-sdk</strong> provides a <code>Logger</code> object,
which is a safe way for app logging.</p>
</div>
<div class="paragraph">
<p>The <code>Logger</code> is a <code>logging.Logger</code> instance
and should be used like every other Python logger.</p>
</div>
<div class="paragraph">
<p>The <code>Logger</code> has following features:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Log messages are injected with contextual information,
which makes it easy to filter through logs
while debugging issues.</p>
</li>
<li>
<p>Log messages have limited length.
Too long messages are truncated to not exceed the limit.
Max message size can be controlled by
<code>LOG_THRESHOLD_MESSAGE_SIZE</code> env variable.
Default value is <code>1000</code> symbols or bytes.</p>
</li>
<li>
<p>Number of log messages is limited.
After reaching the limit logging gets disabled.
Number of log messages can be controlled by
<code>LOG_THRESHOLD_MESSAGE_COUNT</code> env variable.
Default value is <code>15</code> messages.</p>
</li>
<li>
<p>Logging level can be set using <code>LOG_LEVEL</code> env variable.
Default value is <code>INFO</code>,
see <a href="https://docs.python.org/3/howto/logging.html">Python log levels</a> for other available options.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span></span><span class="tok-kn">from</span> <span class="tok-nn">corva</span> <span class="tok-kn">import</span> <span class="tok-n">Api</span><span class="tok-p">,</span> <span class="tok-n">Logger</span><span class="tok-p">,</span> <span class="tok-n">TaskEvent</span><span class="tok-p">,</span> <span class="tok-n">task</span>  <i class="conum" data-value="1"></i><b>(1)</b>


<span class="tok-nd">@task</span>
<span class="tok-k">def</span> <span class="tok-nf">task_app</span><span class="tok-p">(</span><span class="tok-n">event</span><span class="tok-p">:</span> <span class="tok-n">TaskEvent</span><span class="tok-p">,</span> <span class="tok-n">api</span><span class="tok-p">:</span> <span class="tok-n">Api</span><span class="tok-p">):</span>
    <i class="conum" data-value="2"></i><b>(2)</b>
    <span class="tok-n">Logger</span><span class="tok-o">.</span><span class="tok-n">debug</span><span class="tok-p">(</span><span class="tok-s1">&#39;Debug message!&#39;</span><span class="tok-p">)</span>
    <span class="tok-n">Logger</span><span class="tok-o">.</span><span class="tok-n">info</span><span class="tok-p">(</span><span class="tok-s1">&#39;Info message!&#39;</span><span class="tok-p">)</span>
    <span class="tok-n">Logger</span><span class="tok-o">.</span><span class="tok-n">warning</span><span class="tok-p">(</span><span class="tok-s1">&#39;Warning message!&#39;</span><span class="tok-p">)</span>
    <span class="tok-n">Logger</span><span class="tok-o">.</span><span class="tok-n">error</span><span class="tok-p">(</span><span class="tok-s1">&#39;Error message!&#39;</span><span class="tok-p">)</span>
    <span class="tok-k">try</span><span class="tok-p">:</span>
        <span class="tok-mi">0</span> <span class="tok-o">/</span> <span class="tok-mi">0</span>
    <span class="tok-k">except</span> <span class="tok-ne">ZeroDivisionError</span><span class="tok-p">:</span>
        <span class="tok-n">Logger</span><span class="tok-o">.</span><span class="tok-n">exception</span><span class="tok-p">(</span><span class="tok-s1">&#39;Exception message!&#39;</span><span class="tok-p">)</span></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Import <code>Logger</code> object.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Use <code>Logger</code> as every other Python logger.</td>
</tr>
</table>
</div>
<div class="sect2">
<h3 id="_customizations">6.1. Customizations</h3>
<div class="paragraph">
<p>You might want to send logs to other places
(e.g., to error reporting systems like
<a href="#sentry"><code>Sentry</code></a> or <a href="#rollbar"><code>Rollbar</code></a>).
This can be achieved by providing an instance of
<a href="https://docs.python.org/3/howto/logging.html#handlers">logging handler</a>
as an argument to app decorator.
Custom handler will be used alongside <strong>corva-sdk</strong>'s default one.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span></span><span class="tok-kn">import</span> <span class="tok-nn">logging</span>  <i class="conum" data-value="1"></i><b>(1)</b>

<span class="tok-kn">from</span> <span class="tok-nn">corva</span> <span class="tok-kn">import</span> <span class="tok-n">Api</span><span class="tok-p">,</span> <span class="tok-n">Logger</span><span class="tok-p">,</span> <span class="tok-n">TaskEvent</span><span class="tok-p">,</span> <span class="tok-n">task</span>

<span class="tok-n">stream_handler</span> <span class="tok-o">=</span> <span class="tok-n">logging</span><span class="tok-o">.</span><span class="tok-n">StreamHandler</span><span class="tok-p">()</span>  <i class="conum" data-value="2"></i><b>(2)</b>


<span class="tok-nd">@task</span><span class="tok-p">(</span><span class="tok-n">handler</span><span class="tok-o">=</span><span class="tok-n">stream_handler</span><span class="tok-p">)</span>  <i class="conum" data-value="3"></i><b>(3)</b>
<span class="tok-k">def</span> <span class="tok-nf">task_app</span><span class="tok-p">(</span><span class="tok-n">event</span><span class="tok-p">:</span> <span class="tok-n">TaskEvent</span><span class="tok-p">,</span> <span class="tok-n">api</span><span class="tok-p">:</span> <span class="tok-n">Api</span><span class="tok-p">):</span>
    <span class="tok-n">Logger</span><span class="tok-o">.</span><span class="tok-n">info</span><span class="tok-p">(</span><span class="tok-s1">&#39;Info message!&#39;</span><span class="tok-p">)</span>  <i class="conum" data-value="4"></i><b>(4)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Import the module which contains the handler
that we want to use.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Initialize the handler.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Pass the handler as a keyword argument to the app decorator.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Logs will be sent to both <code>stream_handler</code>
and <strong>corva-sdk</strong>'s default one.</td>
</tr>
</table>
</div>
<div class="sect3">
<h4 id="sentry">6.1.1. Sentry</h4>
<div class="paragraph">
<p><a href="https://docs.sentry.io/platforms/python/">
Sentry for Python documentation.
</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="bash"><span></span>pip install sentry-sdk <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Install the library.</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span></span><span class="tok-kn">import</span> <span class="tok-nn">sentry_sdk</span>  <i class="conum" data-value="1"></i><b>(1)</b>

<span class="tok-kn">from</span> <span class="tok-nn">corva</span> <span class="tok-kn">import</span> <span class="tok-n">Api</span><span class="tok-p">,</span> <span class="tok-n">TaskEvent</span><span class="tok-p">,</span> <span class="tok-n">task</span>

<span class="tok-n">sentry_sdk</span><span class="tok-o">.</span><span class="tok-n">init</span><span class="tok-p">(</span><span class="tok-s2">&quot;YOUR_SENTRY_DSN&quot;</span><span class="tok-p">)</span>  <i class="conum" data-value="2"></i><b>(2)</b>


<span class="tok-nd">@task</span>
<span class="tok-k">def</span> <span class="tok-nf">app</span><span class="tok-p">(</span><span class="tok-n">event</span><span class="tok-p">:</span> <span class="tok-n">TaskEvent</span><span class="tok-p">,</span> <span class="tok-n">api</span><span class="tok-p">:</span> <span class="tok-n">Api</span><span class="tok-p">)</span> <span class="tok-o">-&gt;</span> <span class="tok-kc">None</span><span class="tok-p">:</span>
    <span class="tok-mi">1</span> <span class="tok-o">/</span> <span class="tok-mi">0</span>  <i class="conum" data-value="3"></i><b>(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Import Sentry SDK.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Initialize the library.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>All errors will be reported to Sentry now.</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="rollbar">6.1.2. Rollbar</h4>
<div class="paragraph">
<p><a href="https://docs.rollbar.com/docs/python">
Rollbar for Python documentation.
</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="bash"><span></span>pip install rollbar <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Install the library.</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span></span><span class="tok-kn">import</span> <span class="tok-nn">rollbar.logger</span>  <i class="conum" data-value="1"></i><b>(1)</b>

<span class="tok-kn">from</span> <span class="tok-nn">corva</span> <span class="tok-kn">import</span> <span class="tok-n">Api</span><span class="tok-p">,</span> <span class="tok-n">TaskEvent</span><span class="tok-p">,</span> <span class="tok-n">task</span>

<span class="tok-n">rollbar_handler</span> <span class="tok-o">=</span> <span class="tok-n">rollbar</span><span class="tok-o">.</span><span class="tok-n">logger</span><span class="tok-o">.</span><span class="tok-n">RollbarHandler</span><span class="tok-p">(</span><span class="tok-s1">&#39;YOUR_ROLLBAR_ACCESS_TOKEN&#39;</span><span class="tok-p">)</span>  <i class="conum" data-value="2"></i><b>(2)</b>


<span class="tok-nd">@task</span><span class="tok-p">(</span><span class="tok-n">handler</span><span class="tok-o">=</span><span class="tok-n">rollbar_handler</span><span class="tok-p">)</span>  <i class="conum" data-value="3"></i><b>(3)</b>
<span class="tok-k">def</span> <span class="tok-nf">app</span><span class="tok-p">(</span><span class="tok-n">event</span><span class="tok-p">:</span> <span class="tok-n">TaskEvent</span><span class="tok-p">,</span> <span class="tok-n">api</span><span class="tok-p">:</span> <span class="tok-n">Api</span><span class="tok-p">)</span> <span class="tok-o">-&gt;</span> <span class="tok-kc">None</span><span class="tok-p">:</span>
    <span class="tok-mi">1</span> <span class="tok-o">/</span> <span class="tok-mi">0</span>  <i class="conum" data-value="4"></i><b>(4)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Import Rollbar SDK.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Initialize Rollbar handler.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Pass the handler as a keyword argument to the app decorator.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>All errors will be reported to Rollbar now.</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_raygun">6.1.3. Raygun</h4>
<div class="paragraph">
<p><a href="https://raygun.com/documentation/language-guides/python/crash-reporting/installation/">
Raygun for Python documentation.
</a></p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="bash"><span></span>pip install raygun4py <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Install the library.</td>
</tr>
</table>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span></span><span class="tok-kn">import</span> <span class="tok-nn">raygun4py.raygunprovider</span>  <i class="conum" data-value="1"></i><b>(1)</b>

<span class="tok-kn">from</span> <span class="tok-nn">corva</span> <span class="tok-kn">import</span> <span class="tok-n">Api</span><span class="tok-p">,</span> <span class="tok-n">TaskEvent</span><span class="tok-p">,</span> <span class="tok-n">task</span>

<span class="tok-n">raygun_handler</span> <span class="tok-o">=</span> <span class="tok-n">raygun4py</span><span class="tok-o">.</span><span class="tok-n">raygunprovider</span><span class="tok-o">.</span><span class="tok-n">RaygunHandler</span><span class="tok-p">(</span><span class="tok-s1">&#39;YOUR_RAYGUN_API_KEY&#39;</span><span class="tok-p">)</span>  <i class="conum" data-value="2"></i><b>(2)</b>


<span class="tok-nd">@task</span><span class="tok-p">(</span><span class="tok-n">handler</span><span class="tok-o">=</span><span class="tok-n">raygun_handler</span><span class="tok-p">)</span>  <i class="conum" data-value="3"></i><b>(3)</b>
<span class="tok-k">def</span> <span class="tok-nf">app</span><span class="tok-p">(</span><span class="tok-n">event</span><span class="tok-p">:</span> <span class="tok-n">TaskEvent</span><span class="tok-p">,</span> <span class="tok-n">api</span><span class="tok-p">:</span> <span class="tok-n">Api</span><span class="tok-p">)</span> <span class="tok-o">-&gt;</span> <span class="tok-kc">None</span><span class="tok-p">:</span>
    <span class="tok-mi">1</span> <span class="tok-o">/</span> <span class="tok-mi">0</span>  <i class="conum" data-value="4"></i><b>(4)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Import Raygun SDK.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Initialize Raygun handler.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Pass the handler as a keyword argument to the app decorator.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>All errors will be reported to Raygun now.</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_other_libraries">6.1.4. Other libraries</h4>
<div class="paragraph">
<p>You can use any other error logging libraries.
Just initialize
and pass corresponding logging handler
as a keyword argument to the app decorator.
Use code samples above as the examples.</p>
</div>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_secrets">7. Secrets</h2>
<div class="sectionbody">
<div class="paragraph">
<p>You can store sensitive data such as passwords,
tokens,
confidential configuration data,
or any other types of data that you want to protect
as application secrets.
To access such data inside the app
<strong>corva-sdk</strong> provides <code>secrets</code> object.</p>
</div>
<div class="paragraph">
<p>See <a href="#testing_secrets"><code>testing secrets</code></a> section
to see how to test an app
that uses secrets.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span></span><span class="tok-kn">from</span> <span class="tok-nn">corva</span> <span class="tok-kn">import</span> <span class="tok-n">Api</span><span class="tok-p">,</span> <span class="tok-n">TaskEvent</span><span class="tok-p">,</span> <span class="tok-n">secrets</span><span class="tok-p">,</span> <span class="tok-n">task</span>  <i class="conum" data-value="1"></i><b>(1)</b>


<span class="tok-nd">@task</span>
<span class="tok-k">def</span> <span class="tok-nf">task_app</span><span class="tok-p">(</span><span class="tok-n">event</span><span class="tok-p">:</span> <span class="tok-n">TaskEvent</span><span class="tok-p">,</span> <span class="tok-n">api</span><span class="tok-p">:</span> <span class="tok-n">Api</span><span class="tok-p">):</span>
    <span class="tok-n">secrets</span><span class="tok-p">[</span><span class="tok-s1">&#39;api_token&#39;</span><span class="tok-p">]</span>  <i class="conum" data-value="2"></i><b>(2)</b>
    <span class="tok-nb">int</span><span class="tok-p">(</span><span class="tok-n">secrets</span><span class="tok-p">[</span><span class="tok-s1">&#39;integer&#39;</span><span class="tok-p">])</span>  <i class="conum" data-value="3"></i><b>(3)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Import <code>secrets</code> object.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td><code>secrets</code> is a dictionary so
use key to retrieve the value.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Values are stored as strings,
cast the value to required type as needed.
Example shows how to get the integer.</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_testing">8. Testing</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Testing apps is easy and enjoyable.</p>
</div>
<div class="paragraph">
<p><strong>corva-sdk</strong> provides convenient tools for testing through
<a href="https://docs.pytest.org/en/stable/writing_plugins.html">pytest-plugin</a>.</p>
</div>
<div class="paragraph">
<p>Write your tests using <code>pytest</code> to get the access to the plugin.</p>
</div>
<div class="paragraph">
<p>To install the library run:</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="bash"><span></span>pip install pytest</code></pre>
</div>
</div>
<div class="sect2">
<h3 id="_stream">8.1. Stream</h3>
<div class="sect3">
<h4 id="_time">8.1.1. Time</h4>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span></span><span class="tok-kn">from</span> <span class="tok-nn">corva</span> <span class="tok-kn">import</span> <span class="tok-n">Api</span><span class="tok-p">,</span> <span class="tok-n">Cache</span><span class="tok-p">,</span> <span class="tok-n">StreamTimeEvent</span><span class="tok-p">,</span> <span class="tok-n">StreamTimeRecord</span><span class="tok-p">,</span> <span class="tok-n">stream</span>


<span class="tok-nd">@stream</span>
<span class="tok-k">def</span> <span class="tok-nf">stream_app</span><span class="tok-p">(</span><span class="tok-n">event</span><span class="tok-p">:</span> <span class="tok-n">StreamTimeEvent</span><span class="tok-p">,</span> <span class="tok-n">api</span><span class="tok-p">:</span> <span class="tok-n">Api</span><span class="tok-p">,</span> <span class="tok-n">cache</span><span class="tok-p">:</span> <span class="tok-n">Cache</span><span class="tok-p">):</span>  <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="tok-k">return</span> <span class="tok-s1">&#39;Hello, World!&#39;</span>


<span class="tok-k">def</span> <span class="tok-nf">test_stream_time_app</span><span class="tok-p">(</span><span class="tok-n">app_runner</span><span class="tok-p">):</span>  <i class="conum" data-value="2"></i><b>(2)</b>
    <span class="tok-n">event</span> <span class="tok-o">=</span> <span class="tok-n">StreamTimeEvent</span><span class="tok-p">(</span>  <i class="conum" data-value="3"></i><b>(3)</b>
        <span class="tok-n">asset_id</span><span class="tok-o">=</span><span class="tok-mi">0</span><span class="tok-p">,</span> <span class="tok-n">company_id</span><span class="tok-o">=</span><span class="tok-mi">0</span><span class="tok-p">,</span> <span class="tok-n">records</span><span class="tok-o">=</span><span class="tok-p">[</span><span class="tok-n">StreamTimeRecord</span><span class="tok-p">(</span><span class="tok-n">timestamp</span><span class="tok-o">=</span><span class="tok-mi">0</span><span class="tok-p">)]</span>
    <span class="tok-p">)</span>

    <span class="tok-n">result</span> <span class="tok-o">=</span> <span class="tok-n">app_runner</span><span class="tok-p">(</span><span class="tok-n">stream_app</span><span class="tok-p">,</span> <span class="tok-n">event</span><span class="tok-o">=</span><span class="tok-n">event</span><span class="tok-p">)</span>  <i class="conum" data-value="4"></i><b>(4)</b>

    <span class="tok-k">assert</span> <span class="tok-n">result</span> <span class="tok-o">==</span> <span class="tok-s1">&#39;Hello, World!&#39;</span>  <i class="conum" data-value="5"></i><b>(5)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Sample app that we want to test.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Add <code>app_runner</code> argument to your test function.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Define the <a href="#event">event</a> that will be passed to the app.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Use <code>app_runner</code> fixture to run the app.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Verify the result.</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_depth">8.1.2. Depth</h4>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span></span><span class="tok-kn">from</span> <span class="tok-nn">corva</span> <span class="tok-kn">import</span> <span class="tok-n">Api</span><span class="tok-p">,</span> <span class="tok-n">Cache</span><span class="tok-p">,</span> <span class="tok-n">StreamDepthEvent</span><span class="tok-p">,</span> <span class="tok-n">StreamDepthRecord</span><span class="tok-p">,</span> <span class="tok-n">stream</span>


<span class="tok-nd">@stream</span>
<span class="tok-k">def</span> <span class="tok-nf">stream_app</span><span class="tok-p">(</span><span class="tok-n">event</span><span class="tok-p">:</span> <span class="tok-n">StreamDepthEvent</span><span class="tok-p">,</span> <span class="tok-n">api</span><span class="tok-p">:</span> <span class="tok-n">Api</span><span class="tok-p">,</span> <span class="tok-n">cache</span><span class="tok-p">:</span> <span class="tok-n">Cache</span><span class="tok-p">):</span>  <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="tok-k">return</span> <span class="tok-s1">&#39;Hello, World!&#39;</span>


<span class="tok-k">def</span> <span class="tok-nf">test_stream_depth_app</span><span class="tok-p">(</span><span class="tok-n">app_runner</span><span class="tok-p">):</span>  <i class="conum" data-value="2"></i><b>(2)</b>
    <span class="tok-n">event</span> <span class="tok-o">=</span> <span class="tok-n">StreamDepthEvent</span><span class="tok-p">(</span>  <i class="conum" data-value="3"></i><b>(3)</b>
        <span class="tok-n">asset_id</span><span class="tok-o">=</span><span class="tok-mi">0</span><span class="tok-p">,</span> <span class="tok-n">company_id</span><span class="tok-o">=</span><span class="tok-mi">0</span><span class="tok-p">,</span> <span class="tok-n">records</span><span class="tok-o">=</span><span class="tok-p">[</span><span class="tok-n">StreamDepthRecord</span><span class="tok-p">(</span><span class="tok-n">measured_depth</span><span class="tok-o">=</span><span class="tok-mi">0</span><span class="tok-p">)]</span>
    <span class="tok-p">)</span>

    <span class="tok-n">result</span> <span class="tok-o">=</span> <span class="tok-n">app_runner</span><span class="tok-p">(</span><span class="tok-n">stream_app</span><span class="tok-p">,</span> <span class="tok-n">event</span><span class="tok-o">=</span><span class="tok-n">event</span><span class="tok-p">)</span>  <i class="conum" data-value="4"></i><b>(4)</b>

    <span class="tok-k">assert</span> <span class="tok-n">result</span> <span class="tok-o">==</span> <span class="tok-s1">&#39;Hello, World!&#39;</span>  <i class="conum" data-value="5"></i><b>(5)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Sample app that we want to test.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Add <code>app_runner</code> argument to your test function.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Define the <a href="#event">event</a> that will be passed to the app.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Use <code>app_runner</code> fixture to run the app.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Verify the result.</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_scheduled">8.2. Scheduled</h3>
<div class="sect3">
<h4 id="_data_time">8.2.1. Data Time</h4>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span></span><span class="tok-kn">from</span> <span class="tok-nn">corva</span> <span class="tok-kn">import</span> <span class="tok-n">Api</span><span class="tok-p">,</span> <span class="tok-n">Cache</span><span class="tok-p">,</span> <span class="tok-n">ScheduledDataTimeEvent</span><span class="tok-p">,</span> <span class="tok-n">scheduled</span>


<span class="tok-nd">@scheduled</span>
<span class="tok-k">def</span> <span class="tok-nf">scheduled_app</span><span class="tok-p">(</span><span class="tok-n">event</span><span class="tok-p">:</span> <span class="tok-n">ScheduledDataTimeEvent</span><span class="tok-p">,</span> <span class="tok-n">api</span><span class="tok-p">:</span> <span class="tok-n">Api</span><span class="tok-p">,</span> <span class="tok-n">cache</span><span class="tok-p">:</span> <span class="tok-n">Cache</span><span class="tok-p">):</span>  <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="tok-k">return</span> <span class="tok-s1">&#39;Hello, World!&#39;</span>


<span class="tok-k">def</span> <span class="tok-nf">test_scheduled_app</span><span class="tok-p">(</span><span class="tok-n">app_runner</span><span class="tok-p">):</span>  <i class="conum" data-value="2"></i><b>(2)</b>
    <span class="tok-n">event</span> <span class="tok-o">=</span> <span class="tok-n">ScheduledDataTimeEvent</span><span class="tok-p">(</span>
        <span class="tok-n">asset_id</span><span class="tok-o">=</span><span class="tok-mi">0</span><span class="tok-p">,</span> <span class="tok-n">start_time</span><span class="tok-o">=</span><span class="tok-mi">0</span><span class="tok-p">,</span> <span class="tok-n">end_time</span><span class="tok-o">=</span><span class="tok-mi">0</span><span class="tok-p">,</span> <span class="tok-n">company_id</span><span class="tok-o">=</span><span class="tok-mi">0</span>
    <span class="tok-p">)</span>  <i class="conum" data-value="3"></i><b>(3)</b>

    <span class="tok-n">result</span> <span class="tok-o">=</span> <span class="tok-n">app_runner</span><span class="tok-p">(</span><span class="tok-n">scheduled_app</span><span class="tok-p">,</span> <span class="tok-n">event</span><span class="tok-o">=</span><span class="tok-n">event</span><span class="tok-p">)</span>  <i class="conum" data-value="4"></i><b>(4)</b>

    <span class="tok-k">assert</span> <span class="tok-n">result</span> <span class="tok-o">==</span> <span class="tok-s1">&#39;Hello, World!&#39;</span>  <i class="conum" data-value="5"></i><b>(5)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Sample app that we want to test.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Add <code>app_runner</code> argument to your test function.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Define the <a href="#event">event</a> that will be passed to the app.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Use <code>app_runner</code> fixture to run the app.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Verify the result.</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_depth_2">8.2.2. Depth</h4>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span></span><span class="tok-kn">from</span> <span class="tok-nn">corva</span> <span class="tok-kn">import</span> <span class="tok-n">Api</span><span class="tok-p">,</span> <span class="tok-n">Cache</span><span class="tok-p">,</span> <span class="tok-n">ScheduledDepthEvent</span><span class="tok-p">,</span> <span class="tok-n">scheduled</span>


<span class="tok-nd">@scheduled</span>
<span class="tok-k">def</span> <span class="tok-nf">scheduled_app</span><span class="tok-p">(</span><span class="tok-n">event</span><span class="tok-p">:</span> <span class="tok-n">ScheduledDepthEvent</span><span class="tok-p">,</span> <span class="tok-n">api</span><span class="tok-p">:</span> <span class="tok-n">Api</span><span class="tok-p">,</span> <span class="tok-n">cache</span><span class="tok-p">:</span> <span class="tok-n">Cache</span><span class="tok-p">):</span>  <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="tok-k">return</span> <span class="tok-s1">&#39;Hello, World!&#39;</span>


<span class="tok-k">def</span> <span class="tok-nf">test_scheduled_app</span><span class="tok-p">(</span><span class="tok-n">app_runner</span><span class="tok-p">):</span>  <i class="conum" data-value="2"></i><b>(2)</b>
    <span class="tok-n">event</span> <span class="tok-o">=</span> <span class="tok-n">ScheduledDepthEvent</span><span class="tok-p">(</span>
        <span class="tok-n">asset_id</span><span class="tok-o">=</span><span class="tok-mi">0</span><span class="tok-p">,</span>
        <span class="tok-n">company_id</span><span class="tok-o">=</span><span class="tok-mi">0</span><span class="tok-p">,</span>
        <span class="tok-n">top_depth</span><span class="tok-o">=</span><span class="tok-mf">0.0</span><span class="tok-p">,</span>
        <span class="tok-n">bottom_depth</span><span class="tok-o">=</span><span class="tok-mf">1.0</span><span class="tok-p">,</span>
        <span class="tok-n">log_identifier</span><span class="tok-o">=</span><span class="tok-s1">&#39;&#39;</span><span class="tok-p">,</span>
        <span class="tok-n">interval</span><span class="tok-o">=</span><span class="tok-mf">1.0</span><span class="tok-p">,</span>
    <span class="tok-p">)</span>  <i class="conum" data-value="3"></i><b>(3)</b>

    <span class="tok-n">result</span> <span class="tok-o">=</span> <span class="tok-n">app_runner</span><span class="tok-p">(</span><span class="tok-n">scheduled_app</span><span class="tok-p">,</span> <span class="tok-n">event</span><span class="tok-o">=</span><span class="tok-n">event</span><span class="tok-p">)</span>  <i class="conum" data-value="4"></i><b>(4)</b>

    <span class="tok-k">assert</span> <span class="tok-n">result</span> <span class="tok-o">==</span> <span class="tok-s1">&#39;Hello, World!&#39;</span>  <i class="conum" data-value="5"></i><b>(5)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Sample app that we want to test.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Add <code>app_runner</code> argument to your test function.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Define the <a href="#event">event</a> that will be passed to the app.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Use <code>app_runner</code> fixture to run the app.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Verify the result.</td>
</tr>
</table>
</div>
</div>
<div class="sect3">
<h4 id="_natural_time">8.2.3. Natural Time</h4>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span></span><span class="tok-kn">from</span> <span class="tok-nn">corva</span> <span class="tok-kn">import</span> <span class="tok-n">Api</span><span class="tok-p">,</span> <span class="tok-n">Cache</span><span class="tok-p">,</span> <span class="tok-n">ScheduledNaturalTimeEvent</span><span class="tok-p">,</span> <span class="tok-n">scheduled</span>


<span class="tok-nd">@scheduled</span>
<span class="tok-k">def</span> <span class="tok-nf">scheduled_app</span><span class="tok-p">(</span><span class="tok-n">event</span><span class="tok-p">:</span> <span class="tok-n">ScheduledNaturalTimeEvent</span><span class="tok-p">,</span> <span class="tok-n">api</span><span class="tok-p">:</span> <span class="tok-n">Api</span><span class="tok-p">,</span> <span class="tok-n">cache</span><span class="tok-p">:</span> <span class="tok-n">Cache</span><span class="tok-p">):</span>  <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="tok-k">return</span> <span class="tok-s1">&#39;Hello, World!&#39;</span>


<span class="tok-k">def</span> <span class="tok-nf">test_scheduled_app</span><span class="tok-p">(</span><span class="tok-n">app_runner</span><span class="tok-p">):</span>  <i class="conum" data-value="2"></i><b>(2)</b>
    <span class="tok-n">event</span> <span class="tok-o">=</span> <span class="tok-n">ScheduledNaturalTimeEvent</span><span class="tok-p">(</span>
        <span class="tok-n">asset_id</span><span class="tok-o">=</span><span class="tok-mi">0</span><span class="tok-p">,</span> <span class="tok-n">company_id</span><span class="tok-o">=</span><span class="tok-mi">0</span><span class="tok-p">,</span> <span class="tok-n">schedule_start</span><span class="tok-o">=</span><span class="tok-mi">0</span><span class="tok-p">,</span> <span class="tok-n">interval</span><span class="tok-o">=</span><span class="tok-mi">1</span>
    <span class="tok-p">)</span>  <i class="conum" data-value="3"></i><b>(3)</b>

    <span class="tok-n">result</span> <span class="tok-o">=</span> <span class="tok-n">app_runner</span><span class="tok-p">(</span><span class="tok-n">scheduled_app</span><span class="tok-p">,</span> <span class="tok-n">event</span><span class="tok-o">=</span><span class="tok-n">event</span><span class="tok-p">)</span>  <i class="conum" data-value="4"></i><b>(4)</b>

    <span class="tok-k">assert</span> <span class="tok-n">result</span> <span class="tok-o">==</span> <span class="tok-s1">&#39;Hello, World!&#39;</span>  <i class="conum" data-value="5"></i><b>(5)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Sample app that we want to test.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Add <code>app_runner</code> argument to your test function.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Define the <a href="#event">event</a> that will be passed to the app.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Use <code>app_runner</code> fixture to run the app.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Verify the result.</td>
</tr>
</table>
</div>
</div>
</div>
<div class="sect2">
<h3 id="_task">8.3. Task</h3>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span></span><span class="tok-kn">from</span> <span class="tok-nn">corva</span> <span class="tok-kn">import</span> <span class="tok-n">Api</span><span class="tok-p">,</span> <span class="tok-n">TaskEvent</span><span class="tok-p">,</span> <span class="tok-n">task</span>


<span class="tok-nd">@task</span>
<span class="tok-k">def</span> <span class="tok-nf">task_app</span><span class="tok-p">(</span><span class="tok-n">event</span><span class="tok-p">:</span> <span class="tok-n">TaskEvent</span><span class="tok-p">,</span> <span class="tok-n">api</span><span class="tok-p">:</span> <span class="tok-n">Api</span><span class="tok-p">):</span>  <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="tok-k">return</span> <span class="tok-s1">&#39;Hello, World!&#39;</span>


<span class="tok-k">def</span> <span class="tok-nf">test_task_app</span><span class="tok-p">(</span><span class="tok-n">app_runner</span><span class="tok-p">):</span>  <i class="conum" data-value="2"></i><b>(2)</b>
    <span class="tok-n">event</span> <span class="tok-o">=</span> <span class="tok-n">TaskEvent</span><span class="tok-p">(</span><span class="tok-n">asset_id</span><span class="tok-o">=</span><span class="tok-mi">0</span><span class="tok-p">,</span> <span class="tok-n">company_id</span><span class="tok-o">=</span><span class="tok-mi">0</span><span class="tok-p">)</span>  <i class="conum" data-value="3"></i><b>(3)</b>

    <span class="tok-n">result</span> <span class="tok-o">=</span> <span class="tok-n">app_runner</span><span class="tok-p">(</span><span class="tok-n">task_app</span><span class="tok-p">,</span> <span class="tok-n">event</span><span class="tok-o">=</span><span class="tok-n">event</span><span class="tok-p">)</span>  <i class="conum" data-value="4"></i><b>(4)</b>

    <span class="tok-k">assert</span> <span class="tok-n">result</span> <span class="tok-o">==</span> <span class="tok-s1">&#39;Hello, World!&#39;</span>  <i class="conum" data-value="5"></i><b>(5)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Sample app that we want to test.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Add <code>app_runner</code> argument to your test function.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Define the <a href="#event">event</a> that will be passed to the app.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Use <code>app_runner</code> fixture to run the app.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Verify the result.</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="testing_secrets">8.4. Secrets</h3>
<div class="paragraph">
<p>This section shows
how to test an app that uses secrets.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="python"><span></span><span class="tok-kn">from</span> <span class="tok-nn">corva</span> <span class="tok-kn">import</span> <span class="tok-n">Api</span><span class="tok-p">,</span> <span class="tok-n">TaskEvent</span><span class="tok-p">,</span> <span class="tok-n">secrets</span><span class="tok-p">,</span> <span class="tok-n">task</span>


<span class="tok-nd">@task</span>
<span class="tok-k">def</span> <span class="tok-nf">task_app</span><span class="tok-p">(</span><span class="tok-n">event</span><span class="tok-p">:</span> <span class="tok-n">TaskEvent</span><span class="tok-p">,</span> <span class="tok-n">api</span><span class="tok-p">:</span> <span class="tok-n">Api</span><span class="tok-p">):</span>  <i class="conum" data-value="1"></i><b>(1)</b>
    <span class="tok-n">api_token</span> <span class="tok-o">=</span> <span class="tok-n">secrets</span><span class="tok-p">[</span><span class="tok-s1">&#39;api_token&#39;</span><span class="tok-p">]</span>

    <span class="tok-k">return</span> <span class="tok-n">api_token</span>


<span class="tok-k">def</span> <span class="tok-nf">test_task_app</span><span class="tok-p">(</span><span class="tok-n">app_runner</span><span class="tok-p">):</span>  <i class="conum" data-value="2"></i><b>(2)</b>
    <span class="tok-n">event</span> <span class="tok-o">=</span> <span class="tok-n">TaskEvent</span><span class="tok-p">(</span><span class="tok-n">asset_id</span><span class="tok-o">=</span><span class="tok-mi">0</span><span class="tok-p">,</span> <span class="tok-n">company_id</span><span class="tok-o">=</span><span class="tok-mi">0</span><span class="tok-p">)</span>  <i class="conum" data-value="3"></i><b>(3)</b>

    <span class="tok-n">api_token</span> <span class="tok-o">=</span> <span class="tok-n">app_runner</span><span class="tok-p">(</span><span class="tok-n">task_app</span><span class="tok-p">,</span> <span class="tok-n">event</span><span class="tok-p">,</span> <span class="tok-n">secrets</span><span class="tok-o">=</span><span class="tok-p">{</span><span class="tok-s1">&#39;api_token&#39;</span><span class="tok-p">:</span> <span class="tok-s1">&#39;12345&#39;</span><span class="tok-p">})</span>  <i class="conum" data-value="4"></i><b>(4)</b>

    <span class="tok-k">assert</span> <span class="tok-n">api_token</span> <span class="tok-o">==</span> <span class="tok-s1">&#39;12345&#39;</span>  <i class="conum" data-value="5"></i><b>(5)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Sample app that we want to test.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Add <code>app_runner</code> argument to your test function.</td>
</tr>
<tr>
<td><i class="conum" data-value="3"></i><b>3</b></td>
<td>Define the <a href="#event">event</a> that will be passed to the app.</td>
</tr>
<tr>
<td><i class="conum" data-value="4"></i><b>4</b></td>
<td>Use <code>app_runner</code> fixture to run the app.
Pass dictionary with required secrets
as <code>secrets</code> parameter.</td>
</tr>
<tr>
<td><i class="conum" data-value="5"></i><b>5</b></td>
<td>Verify the result.</td>
</tr>
</table>
</div>
</div>
</div>
</div>
<div class="sect1">
<h2 id="_development_contributing">9. Development - Contributing</h2>
<div class="sectionbody">
<div class="paragraph">
<p>Here are some guidelines to set up your environment.</p>
</div>
<div class="sect2">
<h3 id="_create_and_activate_virtual_environment">9.1. Create and activate virtual environment</h3>
<div class="paragraph">
<p>What&#8217;s needed:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Python 3.8.</p>
</li>
<li>
<p>Opened terminal inside cloned <strong>corva-sdk</strong> repository.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="bash"><span></span>python -m venv env <i class="conum" data-value="1"></i><b>(1)</b>
<span class="tok-nb">source</span> ./env/bin/activate <i class="conum" data-value="2"></i><b>(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Create a directory <code>./env/</code>
with isolated Python environment inside.
You will be able to install needed packages there.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Activate the new environment.</td>
</tr>
</table>
</div>
<div class="admonitionblock tip">
<table>
<tr>
<td class="icon">
<i class="fa icon-tip" title="Tip"></i>
</td>
<td class="content">
<div class="paragraph">
<p>From now on
you must always have activated virtual environment
when working with the project.</p>
</div>
</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_install_dependencies_and_run_tests">9.2. Install dependencies and run tests</h3>
<div class="paragraph">
<p>What&#8217;s needed:</p>
</div>
<div class="ulist">
<ul>
<li>
<p>Installed <code>make</code>.</p>
</li>
</ul>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="bash"><span></span>make install <i class="conum" data-value="1"></i><b>(1)</b>
make all  <i class="conum" data-value="2"></i><b>(2)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>Install all development requirements.</td>
</tr>
<tr>
<td><i class="conum" data-value="2"></i><b>2</b></td>
<td>Run tests and linter
to verify that the project was set up properly.</td>
</tr>
</table>
</div>
</div>
<div class="sect2">
<h3 id="_whats_next">9.3. What&#8217;s next?</h3>
<div class="paragraph">
<p>After completing steps above
you can explore the project
and make a contribution.</p>
</div>
<div class="listingblock">
<div class="content">
<pre class="pygments highlight"><code data-lang="bash"><span></span>make <span class="tok-nb">help</span> <i class="conum" data-value="1"></i><b>(1)</b></code></pre>
</div>
</div>
<div class="colist arabic">
<table>
<tr>
<td><i class="conum" data-value="1"></i><b>1</b></td>
<td>List available <code>make</code> targets -
a good starting point for exploration.</td>
</tr>
</table>
</div>
</div>
</div>
</div>
</div>
</body>
</html>